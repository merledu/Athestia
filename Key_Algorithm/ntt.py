
#---------------------------------------------------- PARAMETERS ----------------------------------------------------#
q = 8380417


def preprocess_modular(values):
    return [(x + q) % q for x in values]

def postprocess_modular(values):
    return [x if x < q//2 else x - q for x in values]



def bit_reversal(i, k):
    bin_i = bin(i & (2 ** k - 1))[2:].zfill(k)
    return int(bin_i[::-1], 2)

zeta = [pow(1753, bit_reversal(i, 8), q) for i in range(256)] 
# print(zeta)


def ntt(w1):
    w_hat = w1.copy()

    k = 0
    length = 128
    
    while length >= 1:
        start = 0
        
        while start < 256:
            k += 1
            zeta_val = zeta[k] % q # ζ^brv(k) mod q
            
            for j in range(start, start + length):
                t = (zeta_val * w_hat[j + length]) % q
                w_hat[j + length] = (w_hat[j] - t) % q
                w_hat[j] = (w_hat[j] + t) % q
            
            start += 2 * length
        
        length = length // 2
    
    return w_hat

# Example usage
# Define the polynomial w as a list of 256 integers (example values)
# w1 = [1504003, 7360282, 909405, 4239110, 6401820, 5553100, 1521905, 6711011, 1196868, 1549316, 113661, 3098428, 5081497, 2428526, 2184418, 2360497, 8096820, 5658325, 816041, 4247526, 1910398, 3519499, 7028216, 8211815, 3734939, 6173331, 266241, 277124, 8003761, 4253619, 8194936, 7604638, 92260, 2862904, 3831236, 5890108, 3903392, 5883364, 5982064, 3992596, 6025847, 5085088, 2089551, 5444248, 5211616, 3149758, 7514786, 4340413, 4271882, 4192524, 3245616, 8171262, 2104721, 3796980, 3448131, 8357615, 2552396, 8313076, 5993179, 4448318, 7433369, 2553834, 7131027, 4719558, 5597167, 2497302, 7027396, 3182865, 4650453, 5412687, 6257473, 1332304, 2057684, 1467901, 909295, 6482866, 1282012, 2919689, 1416981, 6147115, 1934307, 2019908, 1253748, 8301865, 2379177, 5334431, 6584782, 7347672, 5867318, 5725691, 2126962, 463797, 5724907, 2449013, 6695297, 578227, 6085628, 4433934, 5040061, 7528968, 5834745, 5931418, 2007202, 2308267, 5478378, 7755762, 7937206, 3668895, 5520727, 7841810, 6480594, 7884023, 6397201, 4847991, 6287567, 3257928, 4483, 4027375, 7681615, 647592, 5832870, 6952751, 5377566, 4970070, 2408573, 3972466, 3557673, 7799142, 4778361, 3303135, 3096488, 1931501, 2496190, 6709534, 5572047, 534235, 5734772, 1929579, 61607, 1043949, 1745689, 329302, 604828, 386528, 2829654, 81438, 2424390, 598083, 3559395, 1830703, 1834855, 5506752, 409844, 6265206, 1362074, 3343035, 3497212, 6798668, 3513142, 2863066, 3874211, 5661980, 2489007, 452485, 6544945, 4469772, 16887, 6343419, 4910236, 3188649, 5347743, 6966527, 7377091, 5514639, 2091659, 3443164, 6957518, 5709763, 6516227, 6919367, 3187451, 8161983, 4618081, 5941208, 4092518, 6429174, 5584795, 4386844, 5463267, 2877962, 7585644, 3987024, 8257698, 4283352, 3329994, 983213, 5475291, 4147943, 1411664, 7018586, 1937822, 6656083, 6503677, 383329, 4552477, 1465115, 5516734, 7803108, 8009943, 8365606, 2624310, 3203521, 7088053, 2734444, 516695, 3461837, 1292505, 4801005, 2148804, 183576, 2437760, 8187445, 3715487, 7682750, 6228286, 1607223, 778870, 2115543, 1890406, 8178776, 3671567, 4301509, 5792567, 2584559, 218857, 2362363, 529520, 3336375, 1240070, 5285148, 3244585, 4967844, 5922552, 862961, 6844536, 1344986, 5408114, 8099575, 4716830, 4413868, 2071661, 3719942, 4933563, 3960927, 1208219, 10286]
w1 = [7880476, 451744, 2612419, 5074264, 8057345, 5862479, 1159470, 6881621, 7803227,5605011, 1092305, 2263375, 6261792, 5577792, 2412368, 5402158, 6079575, 6844413,3702803, 998561, 1690382, 7677673, 6123168, 7766007, 5743168, 6713142, 455819,3067609, 6351809, 4210300, 7162613, 1136664, 7633771, 1138303, 3946536, 8325140,6501646, 140624, 1703426, 4756977, 3741005, 5937215, 6743490, 4503092, 3471245,4330469, 360533, 20109, 2815544, 7575078, 8236038, 1081400, 1015334, 35292,3674209, 4255893, 8342571, 5195190, 1603485, 5624023, 5905260, 284864, 8323159,4548416, 8199809, 3672768, 1133365, 7439825, 2493819, 2862221, 2609935, 3387109,7222932, 2248885, 4727378, 5254835, 242144, 6625078, 6206002, 3877024, 5492396,5710902, 8081480, 1812284, 6965709, 7230310, 8075754, 4624349, 7532030, 4682976,886565, 6908590, 822138, 5185269, 2889917, 7379757, 4349963, 2987836, 6548165,6540583, 250848, 984180, 5155680, 3793668, 8132144, 473768, 3394093, 704340,2556217, 7874274, 7703744, 4758769, 59935, 6254227, 8142451, 7676839, 3657875,5395486, 4193660, 4823889, 5246263, 2037395, 628828, 3315207, 7772682, 8080349,6564651, 3963647, 1913272, 844387, 5495015, 3315844, 7244499, 3131187, 3807466,7518840, 7830114, 6660064, 3840286, 614141, 1031109, 1780498, 3647036, 6185400,6814620, 7588938, 196334, 644539, 2742945, 927420, 1135203, 5214368, 3202752,2062391, 1160126, 1889602, 67381, 126177, 4630344, 4717578, 6203326, 6828681,1749278, 5777169, 700203, 4481208, 1998389, 1159203, 2462815, 1371365, 1935629,2096957, 4338818, 2977425, 1597098, 5275346, 1863803, 4370603, 2365155, 3232473,2522191, 2599081, 3623794, 4818420, 988569, 5584896, 2587033, 2404352, 3604662,4094960, 6155224, 6716109, 5779273, 6185017, 3339991, 3672080, 4719368, 5064736,7749708, 4913372, 2585269, 1646940, 6465207, 8170505, 7402741, 5813164, 6580893,664077, 168097, 3870236, 8372834, 635740, 4470203, 6565736, 238535, 4668018,2352307, 1475803, 6886060, 8060550, 6821470, 8361338, 6718716, 5995672, 5386539,6392092, 6374388, 5405427, 65299, 1441592, 155920, 3488139, 2245751, 5394230,3015088, 2635135, 4191484, 5383295, 2722216, 5684476, 5080686, 5639889, 399119,2843516, 1496287, 5736860, 4368129, 7883109, 7033043, 335948, 6086876, 6674233,4079818, 2719822, 2386356, 2041457]
# w1 = [0, 1, -2, 2, 0, 2, 2, 1, -2, 1, 0, 2, -1, 2, -2, -1, -1, 1, -2, 2, -1, 0, 0, -1, 2, 1, 1, 2, -1, 0, 1, -1, -2, -1, -2, 1, 0, -1, 0, -1, -1, -2, 1, -2, 2, 1, 2, 0, 1, 2, -2, 2, 0, -2, 0, 1, 1, 1, -1, 2, 0, -2, 1, -2, -2, 2, -2, 2, 1, -1, -2, -1, -1, -1, 1, 2, -1, -2, 2, 2, 0, -2, 2, 2, 2, -2, 0, -2, -1, 2, -2, -1, -2, 0, 1, 0, -1, 2, 2, 1, 1, 2, -2, 2, -2, 2, -1, 1, 2, 1, 2, 2, -1, 1, -1, 2, 2, 2, 1, 0, 1, 1, 2, 2, -2, 0, -2, -1, 2, 1, -2, -2, 0, -1, -2, 1, 0, 0, 1, 1, 0, 0, 1, 1, -2, 0, 2, 1, 1, 2, -1, 0, -1, 1, -1, 0, 0, 0, 1, 2, 0, 0, 2, -2, 2, 2, 0, -1, -1, -2, -1, 1, 2, 0, -2, -2, -1, 0, 1, 1, 1, 1, 0, 2, 2, 1, -2, -2, 1, -2, -1, -2, -1, -2, -1, 1, -2, -1, 0, 2, -2, -2, 0, 1, 2, 2, 1, 0, 0, 0, -1, 2, -2, 2, 2, -1, 0, 0, 1, 2, -1, -2, 0, 1, 2, -2, 0, 0, 0, -2, 2, 1, -2, 1, 2, -1, -1, 0, -2, 1, 0, 1, -2, 1, -2, 1, 0, -1, 2, 2, 1, 1, -2, 1, 1, -1]
# w1 = [4958, 8089, 3993, 8582, 623, 9859, 612, 9256, 7372, 634, 7053, 1635, 6335, 4198, 8187, 4280, 4596, 8036, 2684, 152, 5421, 6652, 7468, 8834, 9536, 2583, 7608, 5771, 931, 2588, 2313, 4951, 3699, 9557, 9899, 3907, 5276, 8918, 9998, 7247, 18, 5495, 8753, 2364, 1316, 578, 9593, 1888, 1823, 5739, 2988, 6032, 6433, 741, 6887, 5386, 5849, 5444, 3503, 136, 7973, 7930, 5568, 1534, 2453, 5072, 9775, 4684, 5585, 7113, 9768, 5546, 4724, 6398, 4247, 8706, 7706, 560, 2353, 5692, 1528, 3651, 2843, 8730, 9264, 3389, 4246, 1748, 1569, 7706, 9808, 2927, 7334, 4140, 9338, 9862, 7842, 5860, 6342, 9864, 6207, 6756, 864, 3865, 4412, 6906, 4762, 9365, 4403, 1262, 2853, 1537, 2191, 7116, 8429, 8154, 8904, 7282, 7232, 6213, 4440, 3904, 951, 1483, 5806, 1186, 2233, 1627, 15, 2955, 766, 3909, 7294, 9557, 1342, 2480, 2497, 9629, 41, 794, 899, 484, 9781, 5957, 5833, 7737, 5225, 6423, 3797, 1086, 3018, 998, 6453, 3842, 4227, 6918, 4716, 8892, 8224, 5029, 9962, 1362, 9886, 2671, 8155, 3429, 6987, 7033, 5918, 5703, 2676, 958, 5112, 2872, 7754, 9834, 3893, 221, 9230, 3971, 5809, 890, 5021, 9193, 7286, 5021, 8742, 7491, 729, 4612, 8912, 3106, 8387, 3339, 3620, 2555, 5357, 3996, 367, 8079, 6688, 5772, 3853, 5882, 5340, 9612, 2211, 4024, 8393, 5675, 8138, 1971, 1007, 4918, 5611, 9971, 4110, 7159, 2320, 317, 4596, 4693, 5010, 4351, 9217, 2370, 9914, 4628, 5748, 9119, 4265, 1139, 4913, 4849, 963, 3489, 1032, 5387, 6041, 5798, 4569, 1440, 2515, 1248, 4319, 218, 9761, 4555, 9114, 6227, 7818, 8112, 312, 9585, 6004, 6241]


# zeta = [pow(1753, i, q) for i in range(256)]  # Precompute ζ^brv(k) mod q

# self.ntt_zetas = [pow(self.root_of_unity, self._bit_reversal(i, 8), self.q) for i in range(self.n)]

# s1_processed = preprocess_modular(w1)
# Compute the NTT
w_hat = ntt(w1)
# w_hat = ntt(A)
# w_hat = ntt(s1_processed)
print(w_hat)





def ntt_inverse(w_hat):
    # Initialize w with the input w_hat
    # w = [0] * 256
    # for j in range(256):
    #     w[j] = w_hat[j]
    w = w_hat.copy()

    k = 256
    length = 1
    
    while length < 256:
        start = 0
        
        while start < 256:
            k -= 1
            zeta_val = (-zeta[k]) % q  # -ζ^brv(k) mod q
            
            for j in range(start, start + length):
                t = w[j]
                w[j] = (t + w[j + length]) % q
                w[j + length] = (t - w[j + length]) % q
                w[j + length] = (zeta_val * w[j + length]) % q
            
            start += 2 * length
        
        length *= 2
    
    # Multiply by the inverse factor f
    # f = 8347681  # f = 256^{-1} mod q
    f = pow(256, -1, q)  # Modular inverse of 256 mod q
    for j in range(256):
        w[j] = (f * w[j]) % q
    
    return w

# Example usage
# Define the transformed polynomial w_hat as a list of 256 integers (example values)
# w_hat = [1435785, 7829045, 5131857, 1030506, 6069581, 6626488, 2478644, 285206, 4481108, 3039097, 4838109, 7222012, 3298758, 4811648, 3854692, 4387884, 6505359, 6843674, 2023779, 5964413, 7120086, 3539260, 899586, 6483471, 6462571, 6811886, 1761298, 3330431, 544565, 5007224, 5987151, 1376047, 3015378, 8335059, 1499455, 5023556, 7084435, 6579026, 3792224, 2170336, 6934017, 892172, 1009290, 281694, 5851301, 1365540, 903822, 3643409, 707266, 7140445, 7835167, 4648865, 676125, 291478, 7068888, 716361, 7553311, 3988881, 835693, 6162041, 7398349, 4928172, 2210217, 4132063, 4513089, 768199, 2154620, 3780640, 6612924, 7668586, 5668582, 653742, 4698217, 5632106, 197320, 6405219, 6744634, 6683512, 8223371, 3835917, 3640553, 2585552, 6944919, 6152932, 5160845, 7958291, 7810482, 2348572, 4785210, 7367621, 3105202, 4526306, 1342990, 4146002, 3455534, 2675882, 1632811, 1985259, 5609152, 7192276, 3817954, 1580856, 2040707, 4809521, 3769986, 5648075, 7382101, 783874, 6858707, 4870909, 7230723, 352070, 3131878, 1327518, 8164502, 7605601, 1697675, 4639914, 1058069, 3368030, 5506142, 5333462, 6123642, 1835556, 160169, 2172658, 2332406, 4594917, 3042598, 4901979, 2983064, 923007, 6912130, 4639995, 5986855, 4925990, 2808086, 1713627, 7928433, 3394668, 7336869, 6889198, 141563, 2458214, 3832239, 4946552, 6816491, 7055445, 5725628, 1640278, 4906379, 6589972, 6391107, 3628697, 1016416, 3430140, 2777582, 6730672, 8202744, 2661976, 7211226, 8065909, 6011584, 7331554, 6012293, 4816090, 3882452, 6523107, 4315093, 1996478, 3877205, 76290, 5171684, 6668736, 7389273, 786500, 6408467, 1972257, 143458, 2106279, 4991506, 181651, 4605488, 5615104, 2621957, 7902493, 1658900, 3769648, 1595331, 595047, 95606, 4552863, 5529906, 8368337, 4282582, 796171, 4058995, 5446764, 7360190, 7373932, 4041758, 6804516, 4460835, 1549086, 3954782, 3500414, 3092815, 6113104, 1578769, 2547433, 8369319, 3535040, 2303621, 2603138, 4621285, 6184961, 4276341, 7012036, 2376299, 72409, 298476, 5673870, 5172223, 1188443, 7676832, 7629817, 4851163, 7834211, 2661901, 652097, 1977776, 4229219, 5943687, 1972479, 4939336, 5358903, 2968521, 8071102, 119492, 7386393, 1050085, 4075387, 7301643, 5842203, 1229268, 2532924, 748980, 7494285, 2531694, 603440, 4272269, 2537166, 1036378, 4910863, 5420250, 2697050]
# w_hat = [1466716, 2941622, 1029515, 7805564, 5570211, 6569286, 3508737, 3541372, 5384166, 5568583, 6688691, 3579562, 4953674, 2877071, 8314134, 2777476, 7740016, 882751, 4381328, 5267456, 6462443, 7704006, 3485606, 4093771, 1730478, 388940, 7972972, 6438781, 6005255, 6191504, 4480283, 7865154, 895117, 2867418, 6938848, 7652627, 6216660, 6513665, 1955414, 3923831, 3059517, 3101542, 2183235, 7046630, 4038347, 502796, 387136, 7030117, 3649606, 3256076, 5140827, 116937, 6611519, 5942073, 1567866, 5790503, 1387225, 7159778, 2451677, 3178294, 1801995, 6315106, 7996547, 1998571, 4068579, 1056511, 7955830, 64767, 6122958, 7804122, 1690267, 3061883, 1244005, 3983514, 6145243, 7000239, 4991652, 6057518, 3010791, 659008, 7065489, 3826747, 4688409, 7273016, 5745786, 3920444, 1687284, 4423491, 1899883, 6489941, 2274098, 3881442, 7930949, 965792, 3096266, 2893819, 5595452, 1897723, 3015940, 5842970, 2830649, 434968, 7632442, 6532904, 717389, 208259, 6140055, 6424773, 7164787, 2261250, 8188629, 2186762, 5757743, 468044, 2531937, 3550480, 4003317, 8017254, 2994785, 3828045, 5769776, 3581107, 2456922, 5436970, 7322482, 1894315, 3269022, 5330164, 3087843, 3540257, 1640945, 4894993, 6897597, 2800726, 6353989, 2375747, 6033049, 2845983, 2132489, 6959949, 4783188, 3266254, 4024040, 4081798, 6854974, 4559548, 3533375, 6827725, 1196178, 6231185, 6744021, 4882855, 3803205, 2452135, 3889189, 3186224, 673473, 6688651, 7399799, 6995026, 7435815, 4889092, 3133911, 261330, 6259012, 3305723, 5054776, 3560968, 4175488, 1846462, 4103247, 6640360, 1797788, 6955270, 1485249, 6889794, 4412609, 6084301, 3263554, 4839442, 3439658, 4607531, 4308544, 623290, 3539655, 668150, 1671521, 4800450, 4167672, 8019212, 6889452, 920289, 2695438, 5878856, 2822936, 7124612, 5207352, 6350663, 7918731, 3037754, 1974168, 302233, 5753832, 6906443, 6754703, 8125552, 6143751, 5932804, 4377602, 4512448, 2633204, 3568552, 5148251, 2333428, 2903028, 2761290, 5213749, 1960068, 2492398, 3773118, 1689510, 110694, 6132482, 7115252, 1982019, 1736354, 587559, 7068012, 1861097, 4362324, 3685781, 4461350, 3788989, 3959823, 6699599, 4065320, 2920825, 7583384, 4633147, 6040446, 3372251, 8119847, 8081486, 7574471, 7798398, 6375223, 5516834, 6897073, 6087370, 3482302, 1039951, 7628881, 3593840, 270669, 4383622, 129774]

w_hat = [2910649, 1423034, 7821404, 2138132, 6951900, 2319747, 2866763, 2125647, 2319944, 2411793, 6486114, 2516134, 7129052, 5843595, 7049491, 2797169, 4994691, 238702, 57504, 2514885, 4026254, 2921510, 4997645, 4749067, 4163982, 4636842, 6182751, 1274807, 5641008, 2147921, 2910391, 8058893, 794144, 2511694, 2078945, 6467478, 649616, 1648317, 7946172, 2899108, 1921020, 2141231, 5928124, 7322756, 6066941, 3821046, 6626718, 1643823, 4652837, 812787, 8121388, 7866689, 5039377, 1443660, 5323683, 788542, 5463849, 5150119, 1133567, 1017996, 5373060, 6162927, 3025249, 2848182, 201467, 317806, 2899242, 5874950, 102480, 3531554, 4496480, 8042677, 7065558, 6600442, 2046330, 5891765, 2286204, 8351578, 5419228, 8213157, 1211279, 4170350, 4686847, 1397115, 2761829, 1216952, 880250, 3417046, 6656677, 1125440, 2232029, 2892184, 3731166, 6881387, 1430715, 7069080, 2522339, 482615, 7363565, 7204455, 6350140, 6020620, 6865162, 5549509, 7612549, 490720, 1097501, 8079153, 7328846, 5495031, 4669452, 5487733, 7717333, 1586958, 4598820, 1279002, 5927690, 2065366, 327197, 8091673, 4948110, 1569640, 5370878, 8158571, 3049757, 7820863, 6583693, 4136661, 1809040, 959005, 4029553, 8173424, 5459136, 6469294, 5732401, 4100461, 523168, 6183844, 1317193, 1892320, 2337168, 7867874, 6711388, 1788059, 4398261, 4957884, 1031061, 6261797, 4905351, 1654245, 8036302, 1704021, 4585822, 5307479, 4156726, 7268680, 23941, 5576623, 5432880, 6759117, 6082248, 569395, 5423384, 6836230, 2780070, 4552978, 1136019, 2749729, 2167273, 2550542, 4245160, 863053, 2226391, 4225522, 692735, 1216544, 3408899, 3165722, 6963094, 7006668, 7425828, 5973817, 2440135, 4053090, 4278710, 6179827, 5780827, 8203737, 5218965, 3009147, 3391688, 631332, 3610676, 4741019, 5075235, 1068840, 2402037, 3604469, 6808919, 2854223, 3053173, 4881202, 702773, 5060710, 2645229, 8329514, 5355710, 6368354, 225083, 4675982, 203890, 3823724, 3503402, 3655128, 351819, 406160, 344076, 6596508, 6392286, 3612790, 4680214, 7133695, 3159242, 3118461, 5901717, 238443, 245005, 5181371, 5121789, 6527002, 7775412, 6862118, 5135704, 1806681, 966156, 6712596, 49522, 6435710, 4212535, 2637958, 5987230, 7925726, 165040, 2243734, 4470729, 4317230, 1067241, 2430795, 4213655, 4767260, 2028531, 7479495, 5562456, 3796839, 6029872, 7399780]
# w_hat = [7893247, 5416428, 3332732, 5708052, 1422781, 5562240, 7682719, 7682719, 7893247, 5416428, 3332732, 5708052, 7682719, 7682719, 7682719, 7682719, 6057303, 6057303, 5702220, 6412386, 6057303, 6057303, 5702220, 6412386, 5682534, 5567510, 2033598, 2033598, 3876962, 6313878, 3094755, 3094755, 240157, 240157, 556602, 556602, 7862371, 7862371, 4505141, 4505141, 4209513, 6302294, 4252970, 6767496, 4209513, 6302294, 5510233, 5510233, 240157, 240157, 556602, 556602, 6183756, 6183756, 47168, 3939927, 4209513, 6302294, 5510233, 5510233, 4209513, 6302294, 5510233, 5510233, 8334758, 8334758, 1863721, 6425378, 6012819, 6012819, 8112240, 8112240, 1413331, 1413331, 2709462, 117200, 2446170, 8214943, 2972754, 399874, 2709462, 117200, 1413331, 1413331, 1413331, 1413331, 1413331, 1413331, 1140348, 1140348, 2972754, 399874, 1140348, 1140348, 2972754, 399874, 5044863, 5044863, 7194635, 7194635, 41594, 5623094, 2832344, 2832344, 8332714, 5129351, 2540824, 2540824, 2540824, 2540824, 8332714, 5129351, 1863721, 6425378, 1863721, 6425378, 685348, 2959873, 6425058, 1419005, 1140348, 1140348, 1686314, 1686314, 1140348, 1140348, 2972754, 399874, 6148003, 6230878, 6148003, 6230878, 1033178, 4332530, 2882411, 8129226, 4849041, 4849041, 1834545, 7863537, 1834545, 7863537, 4849041, 4849041, 5498680, 5498680, 482809, 482809, 5498680, 5498680, 2597230, 6748805, 7974245, 7974245, 2015935, 5552138, 6691094, 1921526, 589798, 7967809, 5111727, 5111727, 5880016, 4343438, 5111727, 5111727, 5880016, 4343438, 2328877, 3136451, 2328877, 3136451, 6824191, 6824191, 6824191, 6824191, 1079777, 5936433, 558568, 558568, 3508105, 3508105, 4719532, 4778021, 7535465, 7535465, 2406260, 2406260, 6643742, 698165, 7091293, 7091293, 7925942, 7925942, 1170337, 5054742, 3991274, 2856999, 3991274, 2856999, 3288797, 3288797, 3288797, 3288797, 5739650, 1379302, 3559476, 3559476, 3489631, 3489631, 1657384, 5321878, 7510071, 5718078, 1509058, 1509058, 2013643, 2013643, 4493242, 4493242, 8031345, 6855957, 8031345, 6855957, 6850401, 721843, 1547015, 2280633, 6850401, 721843, 1547015, 2280633, 2849973, 2849973, 2849973, 2849973, 2849973, 2849973, 4198708, 1501238, 4137440, 2606039, 4117001, 2926485, 4137440, 2606039, 4117001, 2926485, 3538136, 3538136, 1512783, 5563489, 1831394, 1952478, 1831394, 1952478]
# w_hat = [1887485, 7178668, 3014272, 2395184, 6096903, 626814, 5015823, 1177129, 2469020, 1696180, 4575082, 5854871, 339352, 1998180, 269714, 8090490, 1670627, 2836286, 6194230, 285262, 4090211, 2021511, 656142, 6877007, 1719393, 2342587, 4070809, 6094434, 4444795, 3538739, 1691765, 5855875, 797478, 1536428, 3524394, 7837373, 4504950, 4599162, 3020037, 4709840, 4090040, 6083919, 5007595, 8244168, 2297109, 6629840, 1786525, 811705, 7219424, 5260180, 7875599, 6509069, 4792915, 4673339, 7894636, 1894676, 1688425, 315479, 8167063, 1404890, 4675698, 1215602, 1112998, 2612454, 1126491, 2701501, 1652255, 214468, 1658121, 7473958, 6620864, 4353638, 708604, 1315425, 2354092, 577074, 6935686, 6429008, 5503123, 4464411, 7511095, 3370231, 2112867, 952923, 4386352, 7370154, 7980640, 1538416, 8378799, 6334588, 7977364, 808207, 6189142, 5447400, 3527410, 1552594, 8248646, 5552092, 6732207, 7568361, 8186714, 1088407, 7185561, 1661081, 5433190, 6959316, 6696554, 7075013, 6797332, 4011329, 1488063, 2568214, 2907496, 3576329, 4784007, 5017047, 2795032, 4276018, 75843, 244763, 5928095, 6973608, 7261175, 6492010, 5248946, 998738, 7482648, 4405255, 1880150, 3473467, 4407105, 5333767, 4618612, 6312176, 4046643, 2480885, 7551494, 2670397, 8275229, 58962, 6196365, 6841678, 6753340, 4753716, 3974087, 3631577, 4742607, 7108580, 7896994, 8146335, 6742074, 2126359, 3311057, 5468242, 5021033, 4765312, 4281516, 2404856, 4967057, 1027839, 6397037, 7101393, 8316570, 7952866, 1536421, 5228672, 7292759, 5894507, 4308729, 512465, 1112321, 1309494, 945877, 2507586, 8172737, 3123073, 4335030, 6608466, 8347693, 1796655, 1663126, 1493838, 638778, 6827480, 3547250, 7514354, 3017015, 5717993, 2204193, 4610003, 6505848, 1873048, 7021746, 5301037, 2651, 6416248, 2512064, 4208714, 7933775, 1613187, 7890584, 5554090, 5836728, 6624179, 668807, 2759365, 4836055, 2677781, 8124812, 6364189, 3341349, 573946, 5959887, 8090224, 2450713, 7598139, 3809398, 1647083, 1386299, 788357, 5694606, 3436213, 6089745, 1583314, 6389215, 5534373, 2806094, 5074432, 3669255, 2350651, 3946087, 2391810, 7982067, 1335157, 6865743, 5770009, 8050701, 3151696, 2988567, 5460300, 7158591, 3677894, 7125872, 6193405, 3431500, 318153, 5550708, 8205554, 6050595, 1441905, 2765164, 2648843, 593610, 672835, 1017464, 6513294]

# w_hat = [5490568, 3613684, 4600186, 2478491, 6246056, 3652416, 6012214, 8219157, 6727900, 2382610, 6832291, 7450424, 907815, 7682907, 3459268, 3609848, 6195500, 405136, 7621195, 248334, 3220617, 2175833, 2352260, 7089623, 4020074, 6213427, 2527846, 7429138, 6999544, 1186882, 3101343, 7435361, 5981894, 7541451, 4715541, 2901097, 5402912, 7725834, 1230626, 2072619, 7991783, 3844773, 1383397, 4583243, 8044557, 7765607, 1385806, 3962639, 5760469, 5996065, 1996518, 628913, 5574056, 4954001, 7353971, 4511181, 2765304, 8333155, 7614721, 2035006, 8379476, 2741076, 7038906, 3550192, 5738363, 588418, 3166249, 6248274, 2593682, 2206637, 4129647, 3985612, 2897488, 3595058, 2452509, 6052571, 8196615, 7073012, 4554819, 4389763, 7464083, 2423240, 6824432, 6865694, 6024359, 2004695, 7425569, 4671534, 1643530, 1505444, 5194258, 5701664, 4965815, 713503, 2547364, 5396658, 4205693, 7237992, 2631853, 6117534, 5698634, 3028526, 6575006, 1096837, 4767151, 3152875, 2470663, 5564669, 3994248, 6042451, 1909829, 8287321, 7992700, 12727, 5893749, 690436, 3100933, 3365152, 2644015, 328408, 1158733, 5880891, 7327186, 513870, 8232623, 579857, 6533404, 7593876, 7772529, 1564319, 5088069, 2575447, 1781113, 7797503, 4661947, 7423384, 8012964, 3080105, 3824135, 5907938, 5836802, 1626015, 8116876, 208538, 8166760, 353456, 516009, 6914942, 5010197, 4461670, 7266118, 203269, 5611503, 2711529, 5250740, 5594044, 1714980, 8104313, 7291838, 5992432, 2370002, 5065357, 3563653, 1927043, 7736515, 4191036, 1358291, 3134211, 7198172, 1627271, 4986459, 6916175, 4495144, 4876714, 2987944, 7052275, 1161047, 1330671, 8357759, 1221870, 8263453, 2640431, 2847381, 8011473, 4013074, 1266294, 8345863, 1471067, 7800365, 3585296, 3703947, 3931817, 3074965, 7487410, 4785794, 4681176, 3176780, 4805149, 2874405, 5749262, 5427515, 7272295, 1200911, 1648076, 6870671, 1445933, 4271706, 7589312, 5713463, 4308755, 1316360, 7253909, 5124805, 6851173, 1074042, 849589, 2806098, 4432704, 6792189, 7019501, 4310014, 1260882, 1859626, 4072089, 1535765, 1179386, 8135319, 3731109, 4284830, 7351607, 495555, 574510, 1978127, 1798821, 1159937, 6006938, 3508211, 4595611, 6548214, 6383581, 787626, 1210233, 1926406, 7698577, 482732, 5436624, 3725231, 7930510, 4248001, 6466583, 231576, 7871019, 8319489, 2298367, 6460142, 4484407]
# w_hat = [5490568, 3613684, 4600186, 2478491, 6246056, 3652416, 6012214, 8219157, 6727900, 2382610, 6832291, 7450424, 907815, 7682907, 3459268, 3609848, 6195500, 405136, 7621195, 248334, 3220617, 2175833, 2352260, 7089623, 4020074, 6213427, 2527846, 7429138, 6999544, 1186882, 3101343, 7435361, 5981894, 7541451, 4715541, 2901097, 5402912, 7725834, 1230626, 2072619, 7991783, 3844773, 1383397, 4583243, 8044557, 7765607, 1385806, 3962639, 5760469, 5996065, 1996518, 628913, 5574056, 4954001, 7353971, 4511181, 2765304, 8333155, 7614721, 2035006, 8379476, 2741076, 7038906, 3550192, 5738363, 588418, 3166249, 6248274, 2593682, 2206637, 4129647, 3985612, 2897488, 3595058, 2452509, 6052571, 8196615, 7073012, 4554819, 4389763, 7464083, 2423240, 6824432, 6865694, 6024359, 2004695, 7425569, 4671534, 1643530, 1505444, 5194258, 5701664, 4965815, 713503, 2547364, 5396658, 4205693, 7237992, 2631853, 6117534, 5698634, 3028526, 6575006, 1096837, 4767151, 3152875, 2470663, 5564669, 3994248, 6042451, 1909829, 8287321, 7992700, 12727, 5893749, 690436, 3100933, 3365152, 2644015, 328408, 1158733, 5880891, 7327186, 513870, 8232623, 579857, 6533404, 7593876, 7772529, 1564319, 5088069, 2575447, 1781113, 7797503, 4661947, 7423384, 8012964, 3080105, 3824135, 5907938, 5836802, 1626015, 8116876, 208538, 8166760, 353456, 516009, 6914942, 5010197, 4461670, 7266118, 203269, 5611503, 2711529, 5250740, 5594044, 1714980, 8104313, 7291838, 5992432, 2370002, 5065357, 3563653, 1927043, 7736515, 4191036, 1358291, 3134211, 7198172, 1627271, 4986459, 6916175, 4495144, 4876714, 2987944, 7052275, 1161047, 1330671, 8357759, 1221870, 8263453, 2640431, 2847381, 8011473, 4013074, 1266294, 8345863, 1471067, 7800365, 3585296, 3703947, 3931817, 3074965, 7487410, 4785794, 4681176, 3176780, 4805149, 2874405, 5749262, 5427515, 7272295, 1200911, 1648076, 6870671, 1445933, 4271706, 7589312, 5713463, 4308755, 1316360, 7253909, 5124805, 6851173, 1074042, 849589, 2806098, 4432704, 6792189, 7019501, 4310014, 1260882, 1859626, 4072089, 1535765, 1179386, 8135319, 3731109, 4284830, 7351607, 495555, 574510, 1978127, 1798821, 1159937, 6006938, 3508211, 4595611, 6548214, 6383581, 787626, 1210233, 1926406, 7698577, 482732, 5436624, 3725231, 7930510, 4248001, 6466583, 231576, 7871019, 8319489, 2298367, 6460142, 4484407]

# Compute the inverse NTT
w = ntt_inverse(w_hat)

# w = postprocess_modular(w)
# print()
print(w)

# # Check if the original and recovered polynomials match
print("Match:", w1 == w)

