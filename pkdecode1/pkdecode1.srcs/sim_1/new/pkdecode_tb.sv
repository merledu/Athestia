`timescale 1ns / 1ps
//////////////////////////////////////////////////////////////////////////////////
// Company: 
// Engineer: 
// 
// Create Date: 24.02.2025 14:44:24
// Design Name: 
// Module Name: pkdecode_tb
// Project Name: 
// Target Devices: 
// Tool Versions: 
// Description: 
// 
// Dependencies: 
// 
// Revision:
// Revision 0.01 - File Created
// Additional Comments:
// 
//////////////////////////////////////////////////////////////////////////////////


module tb_pk_decode;
    
    // Parameters
    parameter int q = 8380417;
    parameter int d = 13;
    parameter int k = 8;
    localparam int bitlen_q = $clog2(q);
    localparam int bitlen_b = bitlen_q - d;
    localparam int coeff_bits = bitlen_b;
    localparam int rho_bits = 256;
    localparam int zi_bits = 256 * coeff_bits;
    localparam int total_pk_bits = rho_bits + k * zi_bits;
    
    // Testbench signals
    logic clk;
    logic rst;
    logic [total_pk_bits-1:0] pk;
    logic [255:0] rho;
    logic [k-1:0][255:0][coeff_bits-1:0] t1;
    
    // Instantiate DUT
    pk_decode #(
        .q(q),
        .d(d),
        .k(k)
    ) dut (
        .clk(clk),
        .rst(rst),
        .pk(pk),
        .rho(rho),
        .t1(t1)
    );
        
    // Testbench sequence
    initial begin
        clk = 1;
        rst = 1;
        pk = 0;
        
        #1
        rst = 0; // Release reset
        
        // Apply test vector
//        pk = 20736'h460dd24b8dfe50f052da81633eaf8ff2c67824e4cef8d30a1ca64a84cd95da64da8d2ccfe43b9ab;
//        1a083f166b83c42b852621ecb6e0eb74cf0b4fc00f55ee982b51095aafb15930662a610fcdc91535beb414ce587cd9f277dea80ae226ff301cff7d474e8a87be56132483bf5be723885a427056fa4c56353943dd5ee8145216a03e82b117aab490794d34337b3925f79c4ced38ed8736e8521011d9e457b3f22edcf7d5763421a2905e42562f95f00c785db905eff2a3c8faec187146821687e97b2beaccd77cba5005adfe534517a1383844f16439b99052b31dbdc09dd429efd980c851bf8c61faa82434ef15fe4a6204463ffc8c449ef48b8bdb52a6ea134188cd254b8141b4cd8fa502fa07802d68146039d9832c0b17eb8c60f5ec9d021118c87126e80e9d3beb1f32522ca14d0f9a213d5994b1f56ce26c7ab3a05a9d5acd7086ae7491b91ec85049a0f07a972250ec78bbe3c6f2662a63b468fab0eb825a278e2f17d2ee888f82f637f04c12839f5f3127efe6b6d4f117979ebda7c1f31c6662721d7ac98496dfdf1f8493ea5a10e6da3cb5d4dc32efe0c72baee096dda0277fb0f25547329091a0d115003b8747c67991869df1101cf57dee0fb256f7d2c64ec3027781ec9416d42250dd9861d48e8fa56df538155efb73981899d8e04a5ef3b3353632a78c1ad2c47f6c9cc3b22957568d21929f051b5c2d320f9e1a2da655166247ac7d199e8a77541c0cc987831c4ecfcc8009be1698a54620554bb190c390e6b93878f8aed8973c2bcd3a8ce061e192178bc2d87159e45918f22ef82a0c6302e7c4c57410332c6684d766f0b87b0e24eb9f841a3fb70558cd8bed702400002abda41dc4ba75ead8a171b0e682cbdb94ba4b12cc06c7d144e80ccd9e3c19c1d3bf28474a69e84cb24be09b4afb6c2f8cf6cbb174245ef250cc6b80a86cf3ce2d27813c011002c4da556c46da09dcac63c6c5032988206b6bc6a2190d693709ecd575dbdde372a52564642c3ab93d91e53fe3b5f7050db248238f638b459b092cd0d59d81f320a2139dcc91cbd00488769a407a7851cd7665c8ade147c3d87798587f08b7374c9bc2e8617567cf69c51710191b6ff03cfb5e3ed9b7237405c071fdfa632a02b9d2294014e244cc5408c94186c489d45801a5d4bff5999b648ba69bd1b5c8cf760f04faf03eb2fe64f8ca39b90e8d687066978e0303cdbb0f0946a941ab1ec45d9dfa9433b1cafe30ec39fee0eab38e7db48294e182d3ce346c43fb29dafd16bcc2e8dbdac4c2b46221829d09289899dbaa8c33b31cc366f48bc252655bc6b35909c3fa71e956406f3d7c2f919d7dc3502253890d2ee623dbed06cc706a694a8c05985a0035abdad560d66c890b5df263684dce237b585d8f956ab4944eba31b6e95b8e9e936fdb6795c8908086279314ae117142b7d76adbc2e28999b684d00bd01717e2cc1ab9a6aefa50c4b2f77a8b54ef245d86f0fb12a3588f5b7becb02cbb636735b360eba1dd095d92310d64da2e694f09631c476e492910e88da18581ac2b961c2a47b1829ad144c8362dc3236a378bb3ecdf81ed3a1e245e6ca1408306dd1ae1a807c742d8675e551869082d729e334ec7528ad59875135580790c9ef35077a88215934eca65927a7924a8ccb9d599d0050207d73ecb7c9a6717fb4d10454a824e409f122cdcae4362547c5bf3fbbebdacccb52c21a29234c2c590017c1d6d1b401a069e3b6c4045bca095aa88b26d321ae6b7230175322235cecf3b269e63cfba525348611fd1b641d2c6eb3acf78ab56fc782eab64f661fed44faf84fc00dfe08580cc70e6251d129a30df9ad21434dc02012d959c408605683b224cb754809daa07d14923988811c4dd44301eea3bf3624427bd89eebfb96fdf1e12da7748bf8903d96c43ff803d4171319624b49cfc6794a7bdf84bbab3a9fc2e029998d1266c04d1c7fb3366f1a5b6e17629ec5dd74f8366231e8532d6f536996595d4515e86b0b1ee3a6d84ada6eadb5b84b847063b765acdbaa09534b7c7fefde7e2e8563b7cbf1953d47197fb92677ba1b74a9b4f7f7ab816ce0af30f123272550fefa0b3c105b5718d85ca1b38210b980fecde18e1d8a3b385de339a4fe863f57ed3705c94b2f597a2c724aebb98a0a02ff9740b11eea8b2f618dc25788c03acefb30eda70cdf1646ed0a888330d25903a39a6c26c33a1bf3c3eabbe55f57b75132a8a89f21bb8f2bfb08e0021ca6c5b7e1de968e7dcc3095c4219c4b2ea8bafed8993c35c599cb3136762bc03739005d5164be560c7ed22a70cfac7f3cf5c6a1477e138f74deaee0fe1c4adc9f7f804c3a64ef3d23c4fae622a423c07aa95b650d10d26acfba4706d03bb70598479174dabb447913f72c7d4b6492e0716c8383c71b2d2c42cfc89f240c6bd18e66815a3f13494b9b66dbd1f1f6de759e9c6a026bf8f76bb1f12a65171339e6173a1c5a77f9a7dacbf400e546f0bc93939c81292bef744222e4bdc37e28299df494f6297629c69e44b0ca1b143346af9288b202deb05b460f56521ba7776869f9d5eaf15e4781795c73b8028cf5988f4d854f421e06937355f6020921195688754476c8d5ab2a1482823a57ac25866909ee26ce4483ed07193adcc7cde7dae5591e43d328912e6cb2c4ca73786d3e494a114e60829b964a42a6f51efd108eace45b4c6b7aac576ad6cce6f84f47ce583f891bd857eda642fee7053b3e07e203e56dcd7e8424b7ee0369733190065d2ef4d7688089eab27e77d4da9aa1878b65925ccc4358c65c6a61e4306c69cecc555869359560abf3331212fb705fcae1f7d38cf8ca020f02b25beccf7a7577ca97970c75b9324a03c1b82b545d8b40cd79dec956ad2c1aeb3b46d581bc95c0996c032676fc43e673e3ed77a1aaa7a52f84893ee9a45426f2d893ceed0c45f9a1ca8a3957cd7579f4d9a1eaf8843cb25b129d15e6aeb0d473e0c82f1f526d75f39d245b9586b558a7efd9e11316fc033c7320c33934dcbda5353be6688e9e044a84ab5e80f30e74a86cc1047199a0e9a5698cd6beebce3b7f88b90acbf720e0afed0facd1ddd6a5804b5a708af1bd83902a56436f45d95e24db623a7d2700168f80a8806164ccda0acfe2f87d259e07cd6cd0a6aaa94b5dae707c4586115398c8846751029bfa74323d9613f97de46962b3147671ec2b575a12c5da45a65d739a03de61cf15a7b87b4f7b9492f49660a7192f5c828e646df8fae178aeaece7ca010386222df61d1f6d9b92e79825223c6934e9551e4c201553c15a2ad8e35a25489edd4404a3963b468c6d3780a2f1fe228a09b62ec405bedcb449adb2b073d9ebe911eac95e15424655fb27591d8863698a8bb3a4d755c67f86442dcb54f1a8736bb27276500f2e0081284b3a5e42dd19ca8ad12a61824ac5c02bff3519c0fcf50c06ae8ef6f3628aca85bf1e9b4c8e210df60235733bc84f2fc306ece30829ce632486c016c7ba6a755f22fa875a34af02fe73250dab2aeec92a36aaa60487b0dffac4c6c5857bd7a6697bc3621bb86c9fce577cf6cb1aa8ee43f4cbf131bd683f3dfab2cba166472459d45dee952fba19b5479b7523838696f203ba825d4d6cd68a313c530a995252fd76ceda2f668443bd75892b3;
       pk = 20736'h460dd24b8dfe50f052da81633eaf8ff2c67824e4cef8d30a1ca64a84cd95da64da8d2ccfe43b9ab1a083f166b83c42b852621ecb6e0eb74cf0b4fc00f55ee982b51095aafb15930662a610fcdc91535beb414ce587cd9f277dea80ae226ff301cff7d474e8a87be56132483bf5be723885a427056fa4c56353943dd5ee8145216a03e82b117aab490794d34337b3925f79c4ced38ed8736e8521011d9e457b3f22edcf7d5763421a2905e42562f95f00c785db905eff2a3c8faec187146821687e97b2beaccd77cba5005adfe534517a1383844f16439b99052b31dbdc09dd429efd980c851bf8c61faa82434ef15fe4a6204463ffc8c449ef48b8bdb52a6ea134188cd254b8141b4cd8fa502fa07802d68146039d9832c0b17eb8c60f5ec9d021118c87126e80e9d3beb1f32522ca14d0f9a213d5994b1f56ce26c7ab3a05a9d5acd7086ae7491b91ec85049a0f07a972250ec78bbe3c6f2662a63b468fab0eb825a278e2f17d2ee888f82f637f04c12839f5f3127efe6b6d4f117979ebda7c1f31c6662721d7ac98496dfdf1f8493ea5a10e6da3cb5d4dc32efe0c72baee096dda0277fb0f25547329091a0d115003b8747c67991869df1101cf57dee0fb256f7d2c64ec3027781ec9416d42250dd9861d48e8fa56df538155efb73981899d8e04a5ef3b3353632a78c1ad2c47f6c9cc3b22957568d21929f051b5c2d320f9e1a2da655166247ac7d199e8a77541c0cc987831c4ecfcc8009be1698a54620554bb190c390e6b93878f8aed8973c2bcd3a8ce061e192178bc2d87159e45918f22ef82a0c6302e7c4c57410332c6684d766f0b87b0e24eb9f841a3fb70558cd8bed702400002abda41dc4ba75ead8a171b0e682cbdb94ba4b12cc06c7d144e80ccd9e3c19c1d3bf28474a69e84cb24be09b4afb6c2f8cf6cbb174245ef250cc6b80a86cf3ce2d27813c011002c4da556c46da09dcac63c6c5032988206b6bc6a2190d693709ecd575dbdde372a52564642c3ab93d91e53fe3b5f7050db248238f638b459b092cd0d59d81f320a2139dcc91cbd00488769a407a7851cd7665c8ade147c3d87798587f08b7374c9bc2e8617567cf69c51710191b6ff03cfb5e3ed9b7237405c071fdfa632a02b9d2294014e244cc5408c94186c489d45801a5d4bff5999b648ba69bd1b5c8cf760f04faf03eb2fe64f8ca39b90e8d687066978e0303cdbb0f0946a941ab1ec45d9dfa9433b1cafe30ec39fee0eab38e7db48294e182d3ce346c43fb29dafd16bcc2e8dbdac4c2b46221829d09289899dbaa8c33b31cc366f48bc252655bc6b35909c3fa71e956406f3d7c2f919d7dc3502253890d2ee623dbed06cc706a694a8c05985a0035abdad560d66c890b5df263684dce237b585d8f956ab4944eba31b6e95b8e9e936fdb6795c8908086279314ae117142b7d76adbc2e28999b684d00bd01717e2cc1ab9a6aefa50c4b2f77a8b54ef245d86f0fb12a3588f5b7becb02cbb636735b360eba1dd095d92310d64da2e694f09631c476e492910e88da18581ac2b961c2a47b1829ad144c8362dc3236a378bb3ecdf81ed3a1e245e6ca1408306dd1ae1a807c742d8675e551869082d729e334ec7528ad59875135580790c9ef35077a88215934eca65927a7924a8ccb9d599d0050207d73ecb7c9a6717fb4d10454a824e409f122cdcae4362547c5bf3fbbebdacccb52c21a29234c2c590017c1d6d1b401a069e3b6c4045bca095aa88b26d321ae6b7230175322235cecf3b269e63cfba525348611fd1b641d2c6eb3acf78ab56fc782eab64f661fed44faf84fc00dfe08580cc70e6251d129a30df9ad21434dc02012d959c408605683b224cb754809daa07d14923988811c4dd44301eea3bf3624427bd89eebfb96fdf1e12da7748bf8903d96c43ff803d4171319624b49cfc6794a7bdf84bbab3a9fc2e029998d1266c04d1c7fb3366f1a5b6e17629ec5dd74f8366231e8532d6f536996595d4515e86b0b1ee3a6d84ada6eadb5b84b847063b765acdbaa09534b7c7fefde7e2e8563b7cbf1953d47197fb92677ba1b74a9b4f7f7ab816ce0af30f123272550fefa0b3c105b5718d85ca1b38210b980fecde18e1d8a3b385de339a4fe863f57ed3705c94b2f597a2c724aebb98a0a02ff9740b11eea8b2f618dc25788c03acefb30eda70cdf1646ed0a888330d25903a39a6c26c33a1bf3c3eabbe55f57b75132a8a89f21bb8f2bfb08e0021ca6c5b7e1de968e7dcc3095c4219c4b2ea8bafed8993c35c599cb3136762bc03739005d5164be560c7ed22a70cfac7f3cf5c6a1477e138f74deaee0fe1c4adc9f7f804c3a64ef3d23c4fae622a423c07aa95b650d10d26acfba4706d03bb70598479174dabb447913f72c7d4b6492e0716c8383c71b2d2c42cfc89f240c6bd18e66815a3f13494b9b66dbd1f1f6de759e9c6a026bf8f76bb1f12a65171339e6173a1c5a77f9a7dacbf400e546f0bc93939c81292bef744222e4bdc37e28299df494f6297629c69e44b0ca1b143346af9288b202deb05b460f56521ba7776869f9d5eaf15e4781795c73b8028cf5988f4d854f421e06937355f6020921195688754476c8d5ab2a1482823a57ac25866909ee26ce4483ed07193adcc7cde7dae5591e43d328912e6cb2c4ca73786d3e494a114e60829b964a42a6f51efd108eace45b4c6b7aac576ad6cce6f84f47ce583f891bd857eda642fee7053b3e07e203e56dcd7e8424b7ee0369733190065d2ef4d7688089eab27e77d4da9aa1878b65925ccc4358c65c6a61e4306c69cecc555869359560abf3331212fb705fcae1f7d38cf8ca020f02b25beccf7a7577ca97970c75b9324a03c1b82b545d8b40cd79dec956ad2c1aeb3b46d581bc95c0996c032676fc43e673e3ed77a1aaa7a52f84893ee9a45426f2d893ceed0c45f9a1ca8a3957cd7579f4d9a1eaf8843cb25b129d15e6aeb0d473e0c82f1f526d75f39d245b9586b558a7efd9e11316fc033c7320c33934dcbda5353be6688e9e044a84ab5e80f30e74a86cc1047199a0e9a5698cd6beebce3b7f88b90acbf720e0afed0facd1ddd6a5804b5a708af1bd83902a56436f45d95e24db623a7d2700168f80a8806164ccda0acfe2f87d259e07cd6cd0a6aaa94b5dae707c4586115398c8846751029bfa74323d9613f97de46962b3147671ec2b575a12c5da45a65d739a03de61cf15a7b87b4f7b9492f49660a7192f5c828e646df8fae178aeaece7ca010386222df61d1f6d9b92e79825223c6934e9551e4c201553c15a2ad8e35a25489edd4404a3963b468c6d3780a2f1fe228a09b62ec405bedcb449adb2b073d9ebe911eac95e15424655fb27591d8863698a8bb3a4d755c67f86442dcb54f1a8736bb27276500f2e0081284b3a5e42dd19ca8ad12a61824ac5c02bff3519c0fcf50c06ae8ef6f3628aca85bf1e9b4c8e210df60235733bc84f2fc306ece30829ce632486c016c7ba6a755f22fa875a34af02fe73250dab2aeec92a36aaa60487b0dffac4c6c5857bd7a6697bc3621bb86c9fce577cf6cb1aa8ee43f4cbf131bd683f3dfab2cba166472459d45dee952fba19b5479b7523838696f203ba825d4d6cd68a313c530a995252fd76ceda2f668443bd75892b3;
        #50;
        
//        pk = {$random, $random, $random, $random};
//        #20;
      
        $finish;
          end
          
           always begin
                 #0.5 clk = ~clk;
             end
      
              initial begin
                 $dumpfile("tb_pk_decode.vcd");
                 $dumpvars(0,tb_pk_decode);
             end
                    
         
         endmodule