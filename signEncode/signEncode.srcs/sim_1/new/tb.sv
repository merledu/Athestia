`timescale 1ns/1ps
import Dilithium_pkg::*;

module tb;
    parameter int L = 7;
    parameter int K = 8;
    parameter int W = 75;

    logic clk, rst, start, done;
    logic [511:0] c_h; 
    logic signed [31:0] z[L-1:0][255:0];
    logic [255:0] h_in[K-1:0];
    logic [8*4627-1:0] sigma;

    sigEncode #(.L(L), .K(K), .W(W)) uut (
        .clk(clk),
        .rst(rst),
        .start(start),
        .c_h(c_h),
        .z(z),
        .h(h_in),
        .sigma(sigma),
        .done(done)
    );
    integer file;
    
    // Clock generation
    always #0.001 clk = ~clk;

    initial begin
        clk   = 0;
        rst   = 1;
        start = 0;
        #20;
        rst = 0;

        // Initialize c_h (example data)
        c_h = 512'h8202727fd526d9d96924b692b4dd4446a827db5c7f40711792a9f218d2340925864730dfd7be980e7d352b8cbfd46ae620c00aa1423661e9edde82511e47d4f1;

        z[0] = '{61156, 200182, -474442, -182287, 399970, 43940, -29300, -254825, 255502, 152953, -28416, -299169, 185451, -152590, -427458, -57268, -449469, 125186, -262606, 269428, 308784, -524111, -125613, -33456, 108007, -174651, -128053, -239154, 86628, 334760, 384932, 492999, 186647, -189775, -222628, 51900, -1245, -492909, -77349, -468763, -467246, -368213, -33795, 24167, 237830, -87913, -32966, -138572, 418170, 204073, 237731, 439824, -509855, 497416, 455843, 496204, 176767, 27406, -391412, 467935, -205008, -276349, 194537, 178481, -515683, 246300, 415558, 277996, -153657, 338869, 192339, 494037, 135487, 60840, -135137, -274323, 159052, -239704, -259469, -202118, -233253, 510911, -353107, -410231, -83298, -296229, 165505, 347226, 520888, 183626, -153467, -121441, 92002, 415108, -392909, -193958, 159685, 46092, 270559, 121756, 300186, -162970, 205318, -495786, 171295, -340774, 74789, 200729, 333005, -6413, 363721, 203161, -407077, 111346, 61679, -133946, -287920, 339677, 375414, -401008, 228540, -97012, -270447, 430051, -293334, 338339, 302518, 318891, 126694, 7169, 303451, 335173, 507940, -452732, 453036, -99091, 332404, -71758, -283313, -6586, 34353, -92195, -501287, -123483, -222272, -318933, 458335, 186847, 208995, -479108, -385548, 42522, -103326, 268532, -473483, 174808, 427401, 486977, 144887, -503644, -69962, 494417, -79553, -226304, -115690, 89652, -221691, -396882, 214259, 121775, 149741, 75757, 515887, -365757, -349478, -255204, 255170, 281467, -134701, -111247, 508189, -371602, 386982, 488255, 351490, 397094, -143092, 157160, 514080, 84050, 363433, 416101, -104924, 178507, -68275, -91935, -444801, 56119, 347899, -430871, -448895, -421121, 421048, -73637, -521077, 353923, -88634, 431116, 19853, 311557, 433329, -291651, 474835, -281870, -31761, 491544, -112137, 178017, -32937, 217655, 102413, 347386, 55177, 344122, -176459, 461187, -290033, 179057, -230301, 359422, -387658, 408264, 218836, 444889, -258183, 307953, 406082, -238600, -216259, -183945, 511344, -271877, -135670, 264438, -30486, -377208, -70235, 79820, -513765, 297969, 157311, 98392, -114507, -190257, -350367, 262932};
        z[1] = '{-88627, 241914, 475205, -332968, -41353, -147594, -167153, -285377, -429518, -116438, -22207, 229680, 75784, 415150, 445623, -301301, -424437, -233405, 159950, 375039, -511630, -333054, 253378, 419122, -383463, -191220, 102335, 14636, 250863, 88843, -183180, 501182, -218644, 398104, -92191, -506619, -302232, -452783, 243673, 105257, -352906, 36934, -142906, 14505, 323023, -276654, -232091, -502849, 22890, -449152, -131911, 85795, -145027, 14033, -80790, -497846, 136343, 56728, 460927, 42045, 382252, 141002, 482376, 378984, 476751, -104279, -74667, -137377, -83018, -171487, 422925, -323709, 365081, 158019, 440387, -262015, 265591, 411216, -289167, 69401, -238747, -158291, 296314, -479651, 390842, -191131, -383932, -324593, -393571, -80112, -489812, -298862, -120923, -239508, -117449, -164815, -324760, 50007, -167211, 48805, 234840, 305211, -85551, -463741, 483280, 269261, 160375, 478580, -137369, -425703, 104751, -76232, 204754, 301651, -387006, 305940, 436277, -148729, -170282, 221501, 116698, 49416, -507467, 383561, -285943, -26154, 119540, -365159, 212980, -479192, -497188, 511351, -214738, -317215, 127610, 495812, 216891, 127485, -50108, 351092, -380731, -259166, -246197, 175895, -462842, -242048, 296248, 94834, -144181, -450662, 315796, 244613, 389728, -333466, 319222, -134438, 283561, -106060, -105339, -513395, 194106, -277938, 460197, -398476, -355673, 82960, -468485, -434011, 274291, -373128, -488850, -37263, -58220, -411265, 63026, 370658, -136304, -39591, -255366, -299640, -492019, 134966, -275913, 15678, -323032, -105613, 378993, 495812, 493846, 304457, 378048, -140859, 347339, 167565, 234370, 375616, 318917, 6959, -2258, 445152, -49406, 357593, -215685, 451939, -124066, -382919, 491750, 366097, -305360, -312623, 202166, -2822, -100184, 513186, -162633, 147349, 56530, -39693, -249899, 442100, -260104, 46045, 75221, 251134, -296664, -1644, 21276, 354179, -158689, 101329, 302327, -199766, 54035, -116008, -439128, -433581, 517610, 269569, -66691, 10354, 7074, 52357, 460197, 152305, 59567, -348136, 500658, -144049, -354473, -232198, -225552, -212597, 303961, -236325, -348876, 208768};
        z[2] = '{111850, -322574, 394029, -94903, -143357, 172460, 31749, -52935, 291458, 294558, 492275, 312127, -445532, 16088, 511937, 317618, 60671, 475611, 360772, 137190, 186603, -90096, 498185, -400127, 379132, 123954, -127573, -389799, 396957, -423857, -442472, 396211, -519914, 156732, -184248, 44025, -422858, 49775, 385381, 448583, -37298, 262616, -94432, 472714, -199880, 272098, 150940, -458059, 433079, 150454, 200467, 220708, -234716, 314289, -48301, -343015, 27731, -91075, -494979, -263030, 201436, 87101, -109767, -249565, -344592, -108700, -51859, -512289, 377362, 393707, -237698, -173607, -378457, 456521, -79976, 223134, 175923, 466968, -383862, 153999, 435708, -483990, 450485, 135450, -103254, -147655, 498035, 310540, -200091, -381716, -198846, -109207, -122492, -488445, 316300, 9181, 143690, -329150, -361524, -335518, 102335, -122159, -190108, 70452, 143215, -500041, -69122, -282747, 149711, -400577, 117507, -250694, 421854, -446357, -93738, -263961, 323863, -393693, -467189, 77008, -228961, -202913, 26505, 357800, 212695, -318063, 302971, 31269, -386690, 514654, 88403, 108569, 159271, 112985, -63405, -494369, -226556, -219068, 336438, -342512, 511888, 123726, 134029, -431073, -508450, 389495, -215147, 362302, 144420, -53553, -307889, -39488, 401010, -208966, -51428, -342537, 440044, 173718, -185646, 230411, -166405, -267871, -4895, -346204, -240686, -146099, -149882, 126242, 508901, -270106, -458262, 483440, -437318, 163029, 273635, -397156, 311200, 430408, -460911, 114028, 445775, 15672, 194409, -464608, -359230, 164825, -513741, -373580, -30599, -150608, -427759, -384940, -257642, 449508, -468837, 379456, -199031, 40000, 82847, -419387, -92, 154673, -186750, -344701, -486059, -38279, -164474, 472269, -350860, 20842, 434472, 390037, 65897, -219735, 37881, 12697, -249143, 268040, 141219, 292286, 483705, -356664, 490222, -360420, -224723, -66875, -364032, 364265, 384799, 485870, 95074, 171742, 397454, 188898, -263459, 432124, -491809, -288785, -413549, 414158, 501331, 522437, 310233, 426472, -382153, 48108, 521735, 199979, 484287, 375555, 286795, -481446, -276165, -255778, 492280, -166148};
        z[3] = '{-36495, 60400, -475512, -66863, 460027, -83690, 492551, 414115, 269786, -281697, -39845, -206724, 521609, 121990, 42125, 282026, -142195, 149997, 131001, -395390, 94536, 236549, 175909, -30665, 14801, 128039, -472555, -288011, -419357, 60369, 9641, 384275, -192483, -46878, 487554, 458018, -80989, 253228, 294957, 314945, -430766, -379846, -380934, -205507, -347107, 448762, 55261, -142960, 387957, 134134, -311145, 130733, 362843, -55627, -486031, 486745, -400459, -212345, 391552, 286456, 218903, 204989, 418016, 463955, 359355, 399527, 437806, -324372, 118485, -407969, -1076, -366883, -408959, 100835, -384944, 328831, -474535, 360264, 109780, 434983, 127152, -476313, -291400, 520484, -362896, 497060, -16350, 66150, -180665, 105081, -263594, -271366, 377650, 94590, 248008, -140979, -517849, -227029, 472060, -166637, 472693, 106459, -78842, 157596, 311195, 303299, 320173, 161331, -325441, -456009, -339852, 488990, -89562, -66864, -59567, 167633, 215059, -286578, -297401, -127496, 135667, -25739, -505250, 214970, 12322, -224464, -223726, -192023, -365316, 169266, 119117, 88829, -356708, -200080, 471455, 7856, 310577, 150148, 317244, -275804, 226679, -265213, -230182, 477196, -154954, -223138, -360645, -257936, -58054, -133745, 115895, -59648, -227887, 7304, -78757, 309062, -116471, -325173, 60283, -425983, -168891, -350330, -393488, 384392, -214346, 76071, 140364, 310593, 369987, 461141, 275084, 518209, 8759, 47941, 503976, 461711, 212222, 228951, 7460, -509661, -486287, 343760, 429040, 162918, -397185, 173128, 381301, -387327, 146830, 287656, 521344, -37196, 85406, 488820, -19968, -360251, 257626, 437449, -267867, 435312, -500240, -268821, -223828, 413142, -366182, 171887, 478955, 389277, 148154, 478280, -165889, -453148, -101274, -260984, -245554, 474497, 483213, 217291, -376761, -477197, 515173, 283642, 67736, 196061, 255208, 504963, -201080, 20683, 363958, -522587, -4831, 153044, 400910, 261248, 120763, 271303, -30305, -323216, 284720, 179813, 501375, -239688, -457492, 29056, 93343, -207980, -159877, 293558, -243651, -212704, 76009, 4627, 301137, -314595, -478792, 323011};
        z[4] = '{-355998, 346244, 210408, -345257, 289543, 444470, -355944, 310077, 53481, -118253, 44840, -427943, -210108, -104558, 501994, 457759, -510153, 15260, 485255, -371925, 416165, -204151, -104010, 277016, -504736, 438834, -244005, 301250, 239660, 149867, 113321, 49488, -189289, 170486, -137081, -492414, 73663, 36503, 422022, 425937, 239305, 337326, -515394, 392111, 220039, 475307, -390816, 435064, 178598, 24406, 335045, -307531, 230165, 413545, -314348, -299704, -47770, 102223, -321541, -309061, 282053, -451857, -139972, 508594, 251050, 316545, 229619, 508696, -177428, -70232, -213558, -5629, 42419, -455556, -169591, 110041, -506033, 67527, 370567, 376231, -504967, -279348, -310199, -342738, 266726, -66510, -19795, -415992, -199312, 240099, -383144, -355513, 5721, 424617, -352364, -434470, -447549, -114886, -417424, -250362, 258947, -475335, -474977, 360736, 217284, -220136, 12808, -104923, -327418, -379561, -356412, -170151, 366274, -521607, 435625, -278758, -294142, -257122, -33768, -13509, -346368, 89717, 301438, 63926, 255735, -23334, -59398, 482695, -138929, -71144, 352982, -209083, -501114, -381938, 464342, 487711, 123101, -300996, 316645, 141498, -178708, 273561, -380694, -496349, -159622, -228607, 162003, -397589, -299468, -279620, 213466, 63922, 225848, 86550, -206432, 182222, 248338, -88151, -389380, -195475, 176641, 280167, 216453, 371895, -340636, -56925, -408376, -227893, -113241, 305293, 385669, -73842, 58163, -318205, 146202, -123249, -523656, -310672, -305336, 359521, 436611, 27046, 30234, -127677, -127867, 64525, -268791, -138353, 480444, 135572, -319311, 478401, -514944, 320381, 24229, 492484, -393444, -91042, 261514, -192653, -248345, -151104, 360722, -140826, -440887, 283843, -50326, 223904, -63842, 231310, 134608, 502310, -461882, 7069, -198352, -114034, -272319, -400933, 500112, 203379, -205345, -376784, -107840, 124580, -126007, -62976, 324502, 241218, 103361, 125726, -177391, -24679, -210670, 103576, 393854, -220458, -311954, 67087, 313880, -459651, -114839, -105153, 79981, -410170, 66547, -471070, 66056, -61684, -169032, 193414, -417469, 415203, 41874, 90171, 101415, 204681};
        z[5] = '{392582, 396813, 48961, -265770, 228620, -242822, 31951, 517167, 64212, 221790, 507884, -300425, -496155, -321300, 229749, -428577, 222616, -258340, -491807, -438630, 17323, -24730, -245274, -58084, 146033, -245349, -54142, -325824, 270030, 171971, 147731, -15202, 27314, 299907, 445343, -385289, 452064, 281048, -234139, -23487, 383631, 152684, 227055, 368716, -170128, -291242, 296336, 209693, 317823, 65887, -109651, 405493, 73608, 116841, -485879, -26670, -72158, 153830, 246098, 120304, -349852, 286617, -222975, -246593, -363347, -185224, 514556, 458304, -79502, 356098, 280387, 89006, -27041, -413340, 347071, -322843, -133390, 235081, 304996, -407112, -48056, -265675, -20774, -148735, 381012, -509033, -118771, 276287, -438315, -445498, 396036, -363324, -24164, -134355, 416437, 76630, -434406, 267939, 322079, -439730, 499809, -349529, 110858, 208194, -68611, 275267, 386526, -412261, -453000, -145652, -401144, 325648, -29142, -251200, 331451, -54558, -217651, -265633, 207452, -246458, -212107, -305565, -441740, 144678, -205191, -284386, -262048, -370452, -47703, -194970, -363096, -287336, 58871, 68342, 365695, -424910, 239159, 359222, 233394, 320072, -492549, 449347, -314076, -229519, -176924, 518680, 34173, 341121, -67726, 514039, -194878, -413251, 287313, -383564, 177141, -479694, -480086, 51901, -321752, -93227, 10826, -160556, -470201, 294545, 162495, 159076, -314367, -376815, -177840, 287466, -49575, 385356, 405490, -334062, -143993, 412998, 262500, -46589, -50720, -501271, 337695, 46555, -242338, -166190, 6414, -154465, -115069, 34842, 105429, 274260, -55949, -243322, -182458, -123778, 75535, -109026, 48246, -224920, 256067, 61305, -97466, 518235, 100326, 476150, 435079, 34320, 338359, 337174, -369393, 107168, -211006, -251108, -397510, -417, 189550, -333475, 479212, 125354, -221637, -113897, -306852, 514232, 375773, 500984, -264661, -356409, 483582, 502298, 341158, -439918, 456439, -168668, -170978, 292992, 141165, -172301, 378140, -43333, 114870, -117626, -222832, 299961, -197914, -485829, -11311, -366469, 422586, 130515, 506942, -407529, -175731, -397983, 383346, 453358, -333693, -148381};
        z[6] = '{333805, 493893, 477694, 173947, -438876, 64402, 152468, -271917, 14162, -140528, -59287, -287574, 215456, -484555, -428972, 313645, -246028, 40074, 236487, -385048, -498646, -169914, 177615, -409146, -297666, -411176, 88592, -175865, -307693, -484236, -414808, 378550, -260364, -289822, -514108, -462419, -322611, 231680, -369385, 108284, 31757, 247959, -466141, -219856, 203105, -440800, -367080, -388037, 350836, -157511, 423138, -313923, 405474, -192458, 279390, 34965, -67337, -18937, -242643, 53213, 281942, 133016, -73291, -480698, 248606, 300322, -195893, 8109, 178027, 52849, -494177, 170079, 340909, 509220, -414106, -118119, 345135, 500282, 220457, -400343, 512901, 256603, 31246, -5447, -281588, -252033, 147959, -77477, 476223, 129887, -79180, 328128, -391826, 445455, -323149, -346856, 170258, -119484, -378579, -414129, 120419, -223888, -409331, 475854, 441562, -327221, -214286, 382054, -477584, 102647, 194473, 493947, 179966, 34648, 416162, -253576, 68973, 86331, -155799, -474092, 66149, 250459, 285491, -168865, -155425, 432961, 78461, 131756, 418939, -182116, -434641, 266878, -31274, 384921, 214130, -98498, 470513, -436533, 322868, -374289, 149022, -495884, -42181, -79179, 203441, -342606, 269533, -222592, 341553, -437900, 392797, -477334, -167119, -360656, 346725, 7139, 346809, -449988, -376380, -33900, 307104, 314272, -462737, -500257, -310085, 365124, -134024, -229623, -76412, -257207, -499713, 383357, -395444, 469445, 511183, -243165, 513285, -67990, -351625, -33053, 334975, 303483, 290778, -360335, 74236, -484763, 289638, 520893, 230514, -124883, 515199, -244767, -40134, -227488, 376717, -354871, 474594, -33518, 489913, -469767, -368261, -151699, -393347, -429272, 344854, 378865, 208489, 308268, 91604, 426716, -438865, 137666, 408178, -91590, 140357, 490843, -368428, -345035, 85861, 485188, 434198, 424898, 1586, -120380, -36754, 518867, 473395, -312148, 9218, -136431, -343947, 231522, 195485, -324888, 164041, 511235, 73166, -392740, -74736, -111960, -465800, -489636, 8463, 465102, 490634, 228705, -139135, -94746, 353747, 267968, -286009, 337654, 56055, -33957, -349191, -19003};
      
        // Initialize h (array of 8 polynomials with 256 coefficients, values 0 or 1)
        h_in[0] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        h_in[1] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        h_in[2] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        h_in[3] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0};
        h_in[4] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        h_in[5] = '{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        h_in[6] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
        h_in[7] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

        file = $fopen("output.txt", "w");

        #10;
        start = 1;
        #10;
        start = 0;

        // Wait until done is asserted.
        wait(done);
        #10;
        if (file) begin
            $fwrite(file, "Sigma Output: %h\n", sigma);
            $fclose(file);
        end else begin
            $display("Error: Unable to open file.");
        end

        $display("Final sigma (4627 bytes):");
        for (int i = 37016-1; i >= 0; i = i - 8) begin
            $write("%02x", sigma[i-:8]);
        end
        $display("");
        #100;
        $finish;
    end

    initial begin
        $dumpfile("signEncode.vcd");
        $dumpvars(0, tb);
    end

endmodule































//module tb;

//    parameter int L = 7;        // Number of polynomials in z
//    parameter int K = 8;        // Number of polynomials in h
//    parameter int W = 75;       // HintBitPack parameter
//    parameter int GAMMA1 = 524288; // Dilithium parameter
//    parameter int COEFF_WIDTH = 256; // Coefficients width

//    logic clk;
//    logic rst;
//    logic startpin;
//    logic donepin;
//    logic [511:0] c_h; // Input signature (64 bytes)
//    logic signed [31:0] z[L-1:0][COEFF_WIDTH-1:0]; // Input vector (z)
//    logic [255:0] h[K-1:0]; // Input hint vector (h)
//    logic [4627 * 8 - 1:0] sigma_out; // Output signature

//    // Instantiate signEncode
//    signEncode #(
//        .L(L),
//        .K(K),
//        .W(W),
//        .GAMMA1(GAMMA1),
//        .COEFF_WIDTH(COEFF_WIDTH)
//    ) uut (
//        .clk(clk),
//        .rst(rst),
//        .startpin(startpin),
//        .donepin(donepin),
//        .c_h(c_h),
//        .z(z),
//        .h(h),
//        .sigma_out(sigma_out)
//    );

//    integer file;
    
//    // *Simulation setup*
//    initial begin
//        clk = 0;
//        rst = 1;
//        startpin = 0;

//        // Initialize c_h (example data)
//        c_h = 512'h8202727fd526d9d96924b692b4dd4446a827db5c7f40711792a9f218d2340925864730dfd7be980e7d352b8cbfd46ae620c00aa1423661e9edde82511e47d4f1;

//        z[0] = '{61156, 200182, -474442, -182287, 399970, 43940, -29300, -254825, 255502, 152953, -28416, -299169, 185451, -152590, -427458, -57268, -449469, 125186, -262606, 269428, 308784, -524111, -125613, -33456, 108007, -174651, -128053, -239154, 86628, 334760, 384932, 492999, 186647, -189775, -222628, 51900, -1245, -492909, -77349, -468763, -467246, -368213, -33795, 24167, 237830, -87913, -32966, -138572, 418170, 204073, 237731, 439824, -509855, 497416, 455843, 496204, 176767, 27406, -391412, 467935, -205008, -276349, 194537, 178481, -515683, 246300, 415558, 277996, -153657, 338869, 192339, 494037, 135487, 60840, -135137, -274323, 159052, -239704, -259469, -202118, -233253, 510911, -353107, -410231, -83298, -296229, 165505, 347226, 520888, 183626, -153467, -121441, 92002, 415108, -392909, -193958, 159685, 46092, 270559, 121756, 300186, -162970, 205318, -495786, 171295, -340774, 74789, 200729, 333005, -6413, 363721, 203161, -407077, 111346, 61679, -133946, -287920, 339677, 375414, -401008, 228540, -97012, -270447, 430051, -293334, 338339, 302518, 318891, 126694, 7169, 303451, 335173, 507940, -452732, 453036, -99091, 332404, -71758, -283313, -6586, 34353, -92195, -501287, -123483, -222272, -318933, 458335, 186847, 208995, -479108, -385548, 42522, -103326, 268532, -473483, 174808, 427401, 486977, 144887, -503644, -69962, 494417, -79553, -226304, -115690, 89652, -221691, -396882, 214259, 121775, 149741, 75757, 515887, -365757, -349478, -255204, 255170, 281467, -134701, -111247, 508189, -371602, 386982, 488255, 351490, 397094, -143092, 157160, 514080, 84050, 363433, 416101, -104924, 178507, -68275, -91935, -444801, 56119, 347899, -430871, -448895, -421121, 421048, -73637, -521077, 353923, -88634, 431116, 19853, 311557, 433329, -291651, 474835, -281870, -31761, 491544, -112137, 178017, -32937, 217655, 102413, 347386, 55177, 344122, -176459, 461187, -290033, 179057, -230301, 359422, -387658, 408264, 218836, 444889, -258183, 307953, 406082, -238600, -216259, -183945, 511344, -271877, -135670, 264438, -30486, -377208, -70235, 79820, -513765, 297969, 157311, 98392, -114507, -190257, -350367, 262932};
//        z[1] = '{-88627, 241914, 475205, -332968, -41353, -147594, -167153, -285377, -429518, -116438, -22207, 229680, 75784, 415150, 445623, -301301, -424437, -233405, 159950, 375039, -511630, -333054, 253378, 419122, -383463, -191220, 102335, 14636, 250863, 88843, -183180, 501182, -218644, 398104, -92191, -506619, -302232, -452783, 243673, 105257, -352906, 36934, -142906, 14505, 323023, -276654, -232091, -502849, 22890, -449152, -131911, 85795, -145027, 14033, -80790, -497846, 136343, 56728, 460927, 42045, 382252, 141002, 482376, 378984, 476751, -104279, -74667, -137377, -83018, -171487, 422925, -323709, 365081, 158019, 440387, -262015, 265591, 411216, -289167, 69401, -238747, -158291, 296314, -479651, 390842, -191131, -383932, -324593, -393571, -80112, -489812, -298862, -120923, -239508, -117449, -164815, -324760, 50007, -167211, 48805, 234840, 305211, -85551, -463741, 483280, 269261, 160375, 478580, -137369, -425703, 104751, -76232, 204754, 301651, -387006, 305940, 436277, -148729, -170282, 221501, 116698, 49416, -507467, 383561, -285943, -26154, 119540, -365159, 212980, -479192, -497188, 511351, -214738, -317215, 127610, 495812, 216891, 127485, -50108, 351092, -380731, -259166, -246197, 175895, -462842, -242048, 296248, 94834, -144181, -450662, 315796, 244613, 389728, -333466, 319222, -134438, 283561, -106060, -105339, -513395, 194106, -277938, 460197, -398476, -355673, 82960, -468485, -434011, 274291, -373128, -488850, -37263, -58220, -411265, 63026, 370658, -136304, -39591, -255366, -299640, -492019, 134966, -275913, 15678, -323032, -105613, 378993, 495812, 493846, 304457, 378048, -140859, 347339, 167565, 234370, 375616, 318917, 6959, -2258, 445152, -49406, 357593, -215685, 451939, -124066, -382919, 491750, 366097, -305360, -312623, 202166, -2822, -100184, 513186, -162633, 147349, 56530, -39693, -249899, 442100, -260104, 46045, 75221, 251134, -296664, -1644, 21276, 354179, -158689, 101329, 302327, -199766, 54035, -116008, -439128, -433581, 517610, 269569, -66691, 10354, 7074, 52357, 460197, 152305, 59567, -348136, 500658, -144049, -354473, -232198, -225552, -212597, 303961, -236325, -348876, 208768};
//        z[2] = '{111850, -322574, 394029, -94903, -143357, 172460, 31749, -52935, 291458, 294558, 492275, 312127, -445532, 16088, 511937, 317618, 60671, 475611, 360772, 137190, 186603, -90096, 498185, -400127, 379132, 123954, -127573, -389799, 396957, -423857, -442472, 396211, -519914, 156732, -184248, 44025, -422858, 49775, 385381, 448583, -37298, 262616, -94432, 472714, -199880, 272098, 150940, -458059, 433079, 150454, 200467, 220708, -234716, 314289, -48301, -343015, 27731, -91075, -494979, -263030, 201436, 87101, -109767, -249565, -344592, -108700, -51859, -512289, 377362, 393707, -237698, -173607, -378457, 456521, -79976, 223134, 175923, 466968, -383862, 153999, 435708, -483990, 450485, 135450, -103254, -147655, 498035, 310540, -200091, -381716, -198846, -109207, -122492, -488445, 316300, 9181, 143690, -329150, -361524, -335518, 102335, -122159, -190108, 70452, 143215, -500041, -69122, -282747, 149711, -400577, 117507, -250694, 421854, -446357, -93738, -263961, 323863, -393693, -467189, 77008, -228961, -202913, 26505, 357800, 212695, -318063, 302971, 31269, -386690, 514654, 88403, 108569, 159271, 112985, -63405, -494369, -226556, -219068, 336438, -342512, 511888, 123726, 134029, -431073, -508450, 389495, -215147, 362302, 144420, -53553, -307889, -39488, 401010, -208966, -51428, -342537, 440044, 173718, -185646, 230411, -166405, -267871, -4895, -346204, -240686, -146099, -149882, 126242, 508901, -270106, -458262, 483440, -437318, 163029, 273635, -397156, 311200, 430408, -460911, 114028, 445775, 15672, 194409, -464608, -359230, 164825, -513741, -373580, -30599, -150608, -427759, -384940, -257642, 449508, -468837, 379456, -199031, 40000, 82847, -419387, -92, 154673, -186750, -344701, -486059, -38279, -164474, 472269, -350860, 20842, 434472, 390037, 65897, -219735, 37881, 12697, -249143, 268040, 141219, 292286, 483705, -356664, 490222, -360420, -224723, -66875, -364032, 364265, 384799, 485870, 95074, 171742, 397454, 188898, -263459, 432124, -491809, -288785, -413549, 414158, 501331, 522437, 310233, 426472, -382153, 48108, 521735, 199979, 484287, 375555, 286795, -481446, -276165, -255778, 492280, -166148};
//        z[3] = '{-36495, 60400, -475512, -66863, 460027, -83690, 492551, 414115, 269786, -281697, -39845, -206724, 521609, 121990, 42125, 282026, -142195, 149997, 131001, -395390, 94536, 236549, 175909, -30665, 14801, 128039, -472555, -288011, -419357, 60369, 9641, 384275, -192483, -46878, 487554, 458018, -80989, 253228, 294957, 314945, -430766, -379846, -380934, -205507, -347107, 448762, 55261, -142960, 387957, 134134, -311145, 130733, 362843, -55627, -486031, 486745, -400459, -212345, 391552, 286456, 218903, 204989, 418016, 463955, 359355, 399527, 437806, -324372, 118485, -407969, -1076, -366883, -408959, 100835, -384944, 328831, -474535, 360264, 109780, 434983, 127152, -476313, -291400, 520484, -362896, 497060, -16350, 66150, -180665, 105081, -263594, -271366, 377650, 94590, 248008, -140979, -517849, -227029, 472060, -166637, 472693, 106459, -78842, 157596, 311195, 303299, 320173, 161331, -325441, -456009, -339852, 488990, -89562, -66864, -59567, 167633, 215059, -286578, -297401, -127496, 135667, -25739, -505250, 214970, 12322, -224464, -223726, -192023, -365316, 169266, 119117, 88829, -356708, -200080, 471455, 7856, 310577, 150148, 317244, -275804, 226679, -265213, -230182, 477196, -154954, -223138, -360645, -257936, -58054, -133745, 115895, -59648, -227887, 7304, -78757, 309062, -116471, -325173, 60283, -425983, -168891, -350330, -393488, 384392, -214346, 76071, 140364, 310593, 369987, 461141, 275084, 518209, 8759, 47941, 503976, 461711, 212222, 228951, 7460, -509661, -486287, 343760, 429040, 162918, -397185, 173128, 381301, -387327, 146830, 287656, 521344, -37196, 85406, 488820, -19968, -360251, 257626, 437449, -267867, 435312, -500240, -268821, -223828, 413142, -366182, 171887, 478955, 389277, 148154, 478280, -165889, -453148, -101274, -260984, -245554, 474497, 483213, 217291, -376761, -477197, 515173, 283642, 67736, 196061, 255208, 504963, -201080, 20683, 363958, -522587, -4831, 153044, 400910, 261248, 120763, 271303, -30305, -323216, 284720, 179813, 501375, -239688, -457492, 29056, 93343, -207980, -159877, 293558, -243651, -212704, 76009, 4627, 301137, -314595, -478792, 323011};
//        z[4] = '{-355998, 346244, 210408, -345257, 289543, 444470, -355944, 310077, 53481, -118253, 44840, -427943, -210108, -104558, 501994, 457759, -510153, 15260, 485255, -371925, 416165, -204151, -104010, 277016, -504736, 438834, -244005, 301250, 239660, 149867, 113321, 49488, -189289, 170486, -137081, -492414, 73663, 36503, 422022, 425937, 239305, 337326, -515394, 392111, 220039, 475307, -390816, 435064, 178598, 24406, 335045, -307531, 230165, 413545, -314348, -299704, -47770, 102223, -321541, -309061, 282053, -451857, -139972, 508594, 251050, 316545, 229619, 508696, -177428, -70232, -213558, -5629, 42419, -455556, -169591, 110041, -506033, 67527, 370567, 376231, -504967, -279348, -310199, -342738, 266726, -66510, -19795, -415992, -199312, 240099, -383144, -355513, 5721, 424617, -352364, -434470, -447549, -114886, -417424, -250362, 258947, -475335, -474977, 360736, 217284, -220136, 12808, -104923, -327418, -379561, -356412, -170151, 366274, -521607, 435625, -278758, -294142, -257122, -33768, -13509, -346368, 89717, 301438, 63926, 255735, -23334, -59398, 482695, -138929, -71144, 352982, -209083, -501114, -381938, 464342, 487711, 123101, -300996, 316645, 141498, -178708, 273561, -380694, -496349, -159622, -228607, 162003, -397589, -299468, -279620, 213466, 63922, 225848, 86550, -206432, 182222, 248338, -88151, -389380, -195475, 176641, 280167, 216453, 371895, -340636, -56925, -408376, -227893, -113241, 305293, 385669, -73842, 58163, -318205, 146202, -123249, -523656, -310672, -305336, 359521, 436611, 27046, 30234, -127677, -127867, 64525, -268791, -138353, 480444, 135572, -319311, 478401, -514944, 320381, 24229, 492484, -393444, -91042, 261514, -192653, -248345, -151104, 360722, -140826, -440887, 283843, -50326, 223904, -63842, 231310, 134608, 502310, -461882, 7069, -198352, -114034, -272319, -400933, 500112, 203379, -205345, -376784, -107840, 124580, -126007, -62976, 324502, 241218, 103361, 125726, -177391, -24679, -210670, 103576, 393854, -220458, -311954, 67087, 313880, -459651, -114839, -105153, 79981, -410170, 66547, -471070, 66056, -61684, -169032, 193414, -417469, 415203, 41874, 90171, 101415, 204681};
//        z[5] = '{392582, 396813, 48961, -265770, 228620, -242822, 31951, 517167, 64212, 221790, 507884, -300425, -496155, -321300, 229749, -428577, 222616, -258340, -491807, -438630, 17323, -24730, -245274, -58084, 146033, -245349, -54142, -325824, 270030, 171971, 147731, -15202, 27314, 299907, 445343, -385289, 452064, 281048, -234139, -23487, 383631, 152684, 227055, 368716, -170128, -291242, 296336, 209693, 317823, 65887, -109651, 405493, 73608, 116841, -485879, -26670, -72158, 153830, 246098, 120304, -349852, 286617, -222975, -246593, -363347, -185224, 514556, 458304, -79502, 356098, 280387, 89006, -27041, -413340, 347071, -322843, -133390, 235081, 304996, -407112, -48056, -265675, -20774, -148735, 381012, -509033, -118771, 276287, -438315, -445498, 396036, -363324, -24164, -134355, 416437, 76630, -434406, 267939, 322079, -439730, 499809, -349529, 110858, 208194, -68611, 275267, 386526, -412261, -453000, -145652, -401144, 325648, -29142, -251200, 331451, -54558, -217651, -265633, 207452, -246458, -212107, -305565, -441740, 144678, -205191, -284386, -262048, -370452, -47703, -194970, -363096, -287336, 58871, 68342, 365695, -424910, 239159, 359222, 233394, 320072, -492549, 449347, -314076, -229519, -176924, 518680, 34173, 341121, -67726, 514039, -194878, -413251, 287313, -383564, 177141, -479694, -480086, 51901, -321752, -93227, 10826, -160556, -470201, 294545, 162495, 159076, -314367, -376815, -177840, 287466, -49575, 385356, 405490, -334062, -143993, 412998, 262500, -46589, -50720, -501271, 337695, 46555, -242338, -166190, 6414, -154465, -115069, 34842, 105429, 274260, -55949, -243322, -182458, -123778, 75535, -109026, 48246, -224920, 256067, 61305, -97466, 518235, 100326, 476150, 435079, 34320, 338359, 337174, -369393, 107168, -211006, -251108, -397510, -417, 189550, -333475, 479212, 125354, -221637, -113897, -306852, 514232, 375773, 500984, -264661, -356409, 483582, 502298, 341158, -439918, 456439, -168668, -170978, 292992, 141165, -172301, 378140, -43333, 114870, -117626, -222832, 299961, -197914, -485829, -11311, -366469, 422586, 130515, 506942, -407529, -175731, -397983, 383346, 453358, -333693, -148381};
//        z[6] = '{333805, 493893, 477694, 173947, -438876, 64402, 152468, -271917, 14162, -140528, -59287, -287574, 215456, -484555, -428972, 313645, -246028, 40074, 236487, -385048, -498646, -169914, 177615, -409146, -297666, -411176, 88592, -175865, -307693, -484236, -414808, 378550, -260364, -289822, -514108, -462419, -322611, 231680, -369385, 108284, 31757, 247959, -466141, -219856, 203105, -440800, -367080, -388037, 350836, -157511, 423138, -313923, 405474, -192458, 279390, 34965, -67337, -18937, -242643, 53213, 281942, 133016, -73291, -480698, 248606, 300322, -195893, 8109, 178027, 52849, -494177, 170079, 340909, 509220, -414106, -118119, 345135, 500282, 220457, -400343, 512901, 256603, 31246, -5447, -281588, -252033, 147959, -77477, 476223, 129887, -79180, 328128, -391826, 445455, -323149, -346856, 170258, -119484, -378579, -414129, 120419, -223888, -409331, 475854, 441562, -327221, -214286, 382054, -477584, 102647, 194473, 493947, 179966, 34648, 416162, -253576, 68973, 86331, -155799, -474092, 66149, 250459, 285491, -168865, -155425, 432961, 78461, 131756, 418939, -182116, -434641, 266878, -31274, 384921, 214130, -98498, 470513, -436533, 322868, -374289, 149022, -495884, -42181, -79179, 203441, -342606, 269533, -222592, 341553, -437900, 392797, -477334, -167119, -360656, 346725, 7139, 346809, -449988, -376380, -33900, 307104, 314272, -462737, -500257, -310085, 365124, -134024, -229623, -76412, -257207, -499713, 383357, -395444, 469445, 511183, -243165, 513285, -67990, -351625, -33053, 334975, 303483, 290778, -360335, 74236, -484763, 289638, 520893, 230514, -124883, 515199, -244767, -40134, -227488, 376717, -354871, 474594, -33518, 489913, -469767, -368261, -151699, -393347, -429272, 344854, 378865, 208489, 308268, 91604, 426716, -438865, 137666, 408178, -91590, 140357, 490843, -368428, -345035, 85861, 485188, 434198, 424898, 1586, -120380, -36754, 518867, 473395, -312148, 9218, -136431, -343947, 231522, 195485, -324888, 164041, 511235, 73166, -392740, -74736, -111960, -465800, -489636, 8463, 465102, 490634, 228705, -139135, -94746, 353747, 267968, -286009, 337654, 56055, -33957, -349191, -19003};
      
//        // Initialize h (array of 8 polynomials with 256 coefficients, values 0 or 1)
//        h[0] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
//        h[1] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
//        h[2] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
//        h[3] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0};
//        h[4] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
//        h[5] = '{0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
//        h[6] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
//        h[7] = '{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};

//        file = $fopen("output.txt", "w");


//        // Simulation sequence
//        #10 rst = 0;
//        #5 startpin = 1;
//        #50 startpin = 0;

//        #100;

//        // Write the output to a file
//        if (file) begin
//            $fwrite(file, "Sigma Output: %h\n", sigma_out);
//            $fclose(file);
//        end else begin
//            $display("Error: Unable to open file.");
//        end

//        // Display result
//        $display("Sigma Output: %h", sigma_out);
//        $finish;
//    end

//    // Clock generation
//    always #0.001 clk = ~clk;

//    initial begin
//        $dumpfile("signEncode.vcd");
//        $dumpvars(0, tb);
//    end
//endmodule












//CORRECT TESTBENCH OF HINTBITPACK
//module tb;

//    parameter int K = 8;
//    parameter int COEFF_WIDTH = 256;
//    parameter int W = 75;

//    logic clk;
//    logic rst;
//    logic [COEFF_WIDTH-1:0] h[K-1:0];
//    logic [7:0] y[W+K-1:0];
//    logic startpin;
//    logic endpin;

//    HintBitPack #(
//        .K(K),
//        .COEFF_WIDTH(COEFF_WIDTH),
//        .W(W)
//    ) uut (
//        .clk(clk),
//        .rst(rst),
//        .h(h),
//        .startpin(startpin),
//        .endpin(endpin),
//        .y(y)
//    );
//    initial begin 
//    clk=1;
//    rst=1;
//     h = '{
    
//     256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100,
//     256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100,
//     256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000011,
//     256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
//     256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
//     256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
//     256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
//     256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000};
//     startpin = 1'b0;
////    h[0] = 256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100;
////    //    result = lsb to msb => 2 ,10,18 26  34  42 50 58 66 74  82  90  98  106  114   122  130  138  146  154 162  170 178  186  194 202 210 218 226  234 242 250                                                                      
////    h[1] = 256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100;
////    h[2] = 256'b01111;
////    h[3] = 256'b010;
////    h[4] = 256'b010;
////    h[5] = 256'b010;
////    h[6] = 256'b0110;
////    h[7] = 256'b0110;
////    h = '{
////           256'b0000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000110,
////           256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000100100,
////           256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111100000,
////           256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000,
////           256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000,
////           256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000,
////           256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000,
////           256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000
////       };
//    #2
//        rst=0;
//        startpin= 1'b1;
////         h = '{
        
////         256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100,
////         256'b0000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100,
////         256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011110000011,
////         256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
////         256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
////         256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
////         256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100,
////         256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000};
////h = '{
////   256'b000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000010000000000000000001000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000010000000000001000000000000,
////256'b0000000001000000000101000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000100000000000000000000000000000000000000000001000000000000000000000000000000000000000000010000000000000000,
////256'b0000000000000000000000010000000000111000000000000000000000000000000000000010000000000000000000000000000000000000001000000000000000000000000000000000000000000000000010000000000000000000000000000110000000001000000000000000000000000000000000000000000000000000,
////256'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000001000000000000000000000000000000000000000000000000000001000010000000000000000100000001000010000000000000000000000000000000000000010000000,
////256'b00000000000000000000000000001000000000000000000000000000000000100000000010000000000000100001000000000000000000000000000000000000000000001000000000000000100000000000000010000000000000000100000000000000000000000000000000000000000000000000000000000000,
////256'b0001000000000000000001000000000000000000000000000000001000000000000000000000000000000000000000000000000010001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000,
////256'b000000000000000000000000000000000010001000000000000000000000000000000000000000100000000000000000000000000001000000000000000000000000010000000000000000000001000000001000000001000000010000000000000000000000000000000000000000000000000000000000000000,
////256'b0000000000000000000000000000000000000000000000000000000100000000000000000000000000000000010000000000000000000000010000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000010000000000000000000000100000000000000000000};
//    h='{
//    256'b0000000000000000100000000000000000000001000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000100000000000000000000000000000000010000000000000000000000000000000000000000000000000000000, 256'b0000000000000000000000000000000000000000001000000010000000010000000100000000100000000000000000000000000100000000000000000010000000000000000000000000100000000000000000000000000001000000000000000000000000000000000000000100010000000000000000000000000000000000, 256'b0000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000100000000000000000000000000000000000000000000000100000000000000000000000000000000001000000000000000001000, 256'b0000000000000000000000000000000000000000000000000000000000000000001000000000000000000001000000000100000000000001000000000000000000000000000000000000000000000000000010000100000000000001000000000100000000000000000000000000000000010000000000000000000000000000, 256'b0000000100000000000000000000000000000000000000100001000000010000000000000000100001000000000000000000000000000000000000000000000000000001000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000, 256'b0000000000000000000000000000000000000000000000000001000000000110000000000000000000000000000100000000000000000000000000000000000000000000000001000000000000000000000000000000000000000100000000000000000000000000000000000001110000000000100000000000000000000000, 256'b0000000000000000010000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000001000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000001010000000001000000000, 256'b0000000000001000000000000100000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000100000000000000000010000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000};
   
//     #420;
//     $finish;
//    end

//    always begin
//        #0.1 clk = ~clk;
//    end
    
//    initial begin
//        $dumpfile("HintBit.vcd");
//        $dumpvars(0,tb);
//    end
           

//endmodule

////clcok 2048 i=8 and j=256 ==>i*j=2048



























//module tb;

//    // Parameters for BitPack module
//    parameter int a = 524287;
//    parameter int b = 524288;
//    parameter b_len = $clog2(a + b)-1;

//    // Testbench signals
//    logic   signed [31:0] w [255:0];  // Input array of 256 elements, each b_len bits wide
////    logic [(b_len * 256) - 1:0] outputt;  // Output bit-string
//    logic [5119:0] outt;  
//    // Instantiate the BitPack module
//    BitPack #(
//        .a(a),
//        .b(b),
//        .b_len(b_len)
//    ) uut (
//        .w(w),
//        .outt(outt)
//    );

//    // Initial block to initialize signals and run the test
//        // Statistically assign values to the w array (256 elements)
//        // For simplicity, we assign static values within the range [-2, 2]
        
//        // Assigning values to w[0] to w[255]
      
//    initial begin
//        // Static assignment of values from -2 to 2 in a repeating pattern
////        w[0] = -2;  w[1] = -1;  w[2] = 0;  w[3] = 1;  w[4] = 2;
////        w[5] = -2;  w[6] = -1;  w[7] = 0;  w[8] = 1;  w[9] = 2;
////        w[10] = -2; w[11] = -1; w[12] = 0; w[13] = 1; w[14] = 2;
////        w[15] = -2; w[16] = -1; w[17] = 0; w[18] = 1; w[19] = 2;
////        w[20] = -2; w[21] = -1; w[22] = 0; w[23] = 1; w[24] = 2;
////        w[25] = -2; w[26] = -1; w[27] = 0; w[28] = 1; w[29] = 2;
////        w[30] = -2; w[31] = -1; w[32] = 0; w[33] = 1; w[34] = 2;
////        w[35] = -2; w[36] = -1; w[37] = 0; w[38] = 1; w[39] = 2;
////        w[40] = -2; w[41] = -1; w[42] = 0; w[43] = 1; w[44] = 2;
////        w[45] = -2; w[46] = -1; w[47] = 0; w[48] = 1; w[49] = 2;
////        w[50] = -2; w[51] = -1; w[52] = 0; w[53] = 1; w[54] = 2;
////        w[55] = -2; w[56] = -1; w[57] = 0; w[58] = 1; w[59] = 2;
////        w[60] = -2; w[61] = -1; w[62] = 0; w[63] = 1; w[64] = 2;
////        w[65] = -2; w[66] = -1; w[67] = 0; w[68] = 1; w[69] = 2;
////        w[70] = -2; w[71] = -1; w[72] = 0; w[73] = 1; w[74] = 2;
////        w[75] = -2; w[76] = -1; w[77] = 0; w[78] = 1; w[79] = 2;
////        w[80] = -2; w[81] = -1; w[82] = 0; w[83] = 1; w[84] = 2;
////        w[85] = -2; w[86] = -1; w[87] = 0; w[88] = 1; w[89] = 2;
////        w[90] = -2; w[91] = -1; w[92] = 0; w[93] = 1; w[94] = 2;
////        w[95] = -2; w[96] = -1; w[97] = 0; w[98] = 1; w[99] = 2;
////        w[100] = -2; w[101] = -1; w[102] = 0; w[103] = 1; w[104] = 2;
////        w[105] = -2; w[106] = -1; w[107] = 0; w[108] = 1; w[109] = 2;
////        w[110] = -2; w[111] = -1; w[112] = 0; w[113] = 1; w[114] = 2;
////        w[115] = -2; w[116] = -1; w[117] = 0; w[118] = 1; w[119] = 2;
////        w[120] = -2; w[121] = -1; w[122] = 0; w[123] = 1; w[124] = 2;
////        w[125] = -2; w[126] = -1; w[127] = 0; w[128] = 1; w[129] = 2;
////        w[130] = -2; w[131] = -1; w[132] = 0; w[133] = 1; w[134] = 2;
////        w[135] = -2; w[136] = -1; w[137] = 0; w[138] = 1; w[139] = 2;
////        w[140] = -2; w[141] = -1; w[142] = 0; w[143] = 1; w[144] = 2;
////        w[145] = -2; w[146] = -1; w[147] = 0; w[148] = 1; w[149] = 2;
////        w[150] = -2; w[151] = -1; w[152] = 0; w[153] = 1; w[154] = 2;
////        w[155] = -2; w[156] = -1; w[157] = 0; w[158] = 1; w[159] = 2;
////        w[160] = -2; w[161] = -1; w[162] = 0; w[163] = 1; w[164] = 2;
////        w[165] = -2; w[166] = -1; w[167] = 0; w[168] = 1; w[169] = 2;
////        w[170] = -2; w[171] = -1; w[172] = 0; w[173] = 1; w[174] = 2;
////        w[175] = -2; w[176] = -1; w[177] = 0; w[178] = 1; w[179] = 2;
////        w[180] = -2; w[181] = -1; w[182] = 0; w[183] = 1; w[184] = 2;
////        w[185] = -2; w[186] = -1; w[187] = 0; w[188] = 1; w[189] = 2;
////        w[190] = -2; w[191] = -1; w[192] = 0; w[193] = 1; w[194] = 2;
////        w[195] = -2; w[196] = -1; w[197] = 0; w[198] = 1; w[199] = 2;
////        w[200] = -2; w[201] = -1; w[202] = 0; w[203] = 1; w[204] = 2;
////        w[205] = -2; w[206] = -1; w[207] = 0; w[208] = 1; w[209] = 2;
////        w[210] = -2; w[211] = -1; w[212] = 0; w[213] = 1; w[214] = 2;
////        w[215] = -2; w[216] = -1; w[217] = 0; w[218] = 1; w[219] = 2;
////        w[220] = -2; w[221] = -1; w[222] = 0; w[223] = 1; w[224] = 2;
////        w[225] = -2; w[226] = -1; w[227] = 0; w[228] = 1; w[229] = 2;
////        w[230] = -2; w[231] = -1; w[232] = 0; w[233] = 1; w[234] = 2;
////        w[235] = -2; w[236] = -1; w[237] = 0; w[238] = 1; w[239] = 2;
////        w[240] = -2; w[241] = -1; w[242] = 0; w[243] = 1; w[244] = 2;
////        w[245] = -2; w[246] = -1; w[247] = 0; w[248] = 1; w[249] = 2;
////        w[250] = -2; w[251] = -1; w[252] = 0; w[253] = 1; w[254] = 2;
////        w[255] = -2;


//        w[0] = 61156;   w[1] = 200182;   w[2] = -474442;  w[3] = -182287;  w[4] = 399970;
//        w[5] = 43940;   w[6] = -29300;   w[7] = -254825;  w[8] = 255502;   w[9] = 152953;
//        w[10] = -28416;  w[11] = -299169; w[12] = 185451;  w[13] = -152590; w[14] = -427458;
//        w[15] = -57268;  w[16] = -449469; w[17] = 125186;  w[18] = -262606; w[19] = 269428;
//        w[20] = 308784;  w[21] = -524111; w[22] = -125613; w[23] = -33456;  w[24] = 108007;
//        w[25] = -174651; w[26] = -128053; w[27] = -239154; w[28] = 86628;   w[29] = 334760;
//        w[30] = 384932;  w[31] = 492999;  w[32] = 186647;  w[33] = -189775; w[34] = -222628;
//        w[35] = 51900;   w[36] = -1245;   w[37] = -492909; w[38] = -77349;  w[39] = -468763;
//        w[40] = -467246; w[41] = -368213; w[42] = -33795;  w[43] = 24167;   w[44] = 237830;
//        w[45] = -87913;  w[46] = -32966;  w[47] = -138572; w[48] = 418170;  w[49] = 204073;
//        w[50] = 237731;  w[51] = 439824;  w[52] = -509855; w[53] = 497416;  w[54] = 455843;
//        w[55] = 496204;  w[56] = 176767;  w[57] = 27406;   w[58] = -391412; w[59] = 467935;
//        w[60] = -205008; w[61] = -276349; w[62] = 194537;  w[63] = 178481;  w[64] = -515683;
//        w[65] = 246300;  w[66] = 415558;  w[67] = 277996;  w[68] = -153657; w[69] = 338869;
//        w[70] = 192339;  w[71] = 494037;  w[72] = 135487;  w[73] = 60840;   w[74] = -135137;
//        w[75] = -274323; w[76] = 159052;  w[77] = -239704; w[78] = -259469; w[79] = -202118;
//        w[80] = -233253; w[81] = 510911;  w[82] = -353107; w[83] = -410231; w[84] = -83298;
//        w[85] = -296229; w[86] = 165505;  w[87] = 347226;  w[88] = 520888;  w[89] = 183626;
//        w[90] = -153467; w[91] = -121441; w[92] = 92002;   w[93] = 415108;  w[94] = -392909;
//        w[95] = -193958; w[96] = 159685;  w[97] = 46092;   w[98] = 270559;  w[99] = 121756;
//        w[100] = 300186;  w[101] = -162970; w[102] = 205318; w[103] = -495786; w[104] = 171295;
//        w[105] = -340774; w[106] = 74789;  w[107] = 200729; w[108] = 333005; w[109] = -6413;
//        w[110] = 363721;  w[111] = 203161; w[112] = -407077; w[113] = 111346; w[114] = 61679;
//        w[115] = -133946; w[116] = -287920; w[117] = 339677; w[118] = 375414; w[119] = -401008;
//        w[120] = 228540;  w[121] = -97012; w[122] = -270447; w[123] = 430051; w[124] = -293334;
//        w[125] = 338339;  w[126] = 302518; w[127] = 318891; w[128] = 126694; w[129] = 7169;
//        w[130] = 303451;  w[131] = 335173; w[132] = 507940; w[133] = -452732; w[134] = 453036;
//        w[135] = -99091;  w[136] = 332404; w[137] = -71758; w[138] = -283313; w[139] = -6586;
//        w[140] = 34353;   w[141] = -92195; w[142] = -501287; w[143] = -123483; w[144] = -222272;
//        w[145] = -318933; w[146] = 458335; w[147] = 186847; w[148] = 208995; w[149] = -479108;
//        w[150] = -385548; w[151] = 42522;  w[152] = -103326; w[153] = 268532; w[154] = -473483;
//        w[155] = 174808;  w[156] = 427401; w[157] = 486977; w[158] = 144887; w[159] = -503644;
//        w[160] = -69962;  w[161] = 494417; w[162] = -79553; w[163] = -226304; w[164] = -115690;
//        w[165] = 89652;   w[166] = -221691; w[167] = -396882; w[168] = 214259; w[169] = 121775;
//        w[170] = 149741;  w[171] = 75757;  w[172] = 515887; w[173] = -365757; w[174] = -349478;
//        w[175] = -255204; w[176] = 255170; w[177] = 281467; w[178] = -134701; w[179] = -111247;
//        w[180] = 508189;  w[181] = -371602; w[182] = 386982; w[183] = 488255; w[184] = 351490;
//        w[185] = 397094;  w[186] = -143092; w[187] = 157160; w[188] = 514080; w[189] = 84050;
//        w[190] = 363433;  w[191] = 416101; w[192] = -104924; w[193] = 178507; w[194] = -68275;
//        w[195] = -91935;  w[196] = -444801; w[197] = 56119;  w[198] = 347899; w[199] = -430871;
//        w[200] = -448895; w[201] = -421121; w[202] = 421048; w[203] = -73637; w[204] = -521077;
//        w[205] = 353923;  w[206] = -88634;  w[207] = 431116; w[208] = 19853;  w[209] = 311557;
//        w[210] = 433329;  w[211] = -291651; w[212] = 474835; w[213] = -281870; w[214] = -31761;
//        w[215] = 491544;  w[216] = -112137; w[217] = 178017; w[218] = -32937; w[219] = 217655;
//        w[220] = 102413;  w[221] = 347386;  w[222] = 55177;  w[223] = 344122; w[224] = -176459;
//        w[225] = 461187;  w[226] = -290033; w[227] = 179057; w[228] = -230301; w[229] = 359422;
//        w[230] = -387658; w[231] = 408264;  w[232] = 218836; w[233] = 444889; w[234] = -258183;
//        w[235] = 307953;  w[236] = 406082;  w[237] = -238600; w[238] = -216259; w[239] = -183945;
//        w[240] = 511344;  w[241] = -271877; w[242] = -135670; w[243] = 264438; w[244] = -30486;
//        w[245] = -377208; w[246] = -70235;  w[247] = 79820;  w[248] = -513765; w[249] = 297969;
//        w[250] = 157311;  w[251] = 98392;   w[252] = -114507; w[253] = -190257; w[254] = -350367;
//        w[255] = 262932;
//        // Display the values for verification
//        $display("hash : %h",outt);
//   end
  
//        // Apply the reset and start the simulation
     
//endmodule


