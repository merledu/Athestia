`timescale 1ns/1ps

module sign;
    // Parameters for the testbench
//    localparam int SK_WIDTH = 8 * (32 + 32 + 64 + 32 * (((Dilithium_pkg::l + Dilithium_pkg::k) * ($clog2(2 * Dilithium_pkg::eta)+1)) 
//                                                   + (Dilithium_pkg::d * Dilithium_pkg::k))) - 1;

    // Testbench signals
    logic [8 * (32 + 32 + 64 + 32 * (((Dilithium_pkg::l + Dilithium_pkg::k) * ($clog2(2 * Dilithium_pkg::eta)+1)) + (Dilithium_pkg::d * Dilithium_pkg::k))) - 1:0] sk;
    logic clk;
    logic rst;

    // Clock generation
    initial begin
        clk = 0;
        forever #0.01 clk = ~clk; // 100 MHz clock
    end

    // DUT instantiation
    sign_internal2 uut (
        .sk(sk),
        .clk(clk),
        .rst(rst),
        .msg('h54d87adc8238c72daf866f3d53f2b84903f4df97638161a0e23c6bcc13de88bbbe4dc6b9905e743fd17dfba4f3c871d9a72545b901f22ea8bee7b6a7e7c473c030cacd15d67843a29fb957245950a35ccad3ad24313768cc1e1dfba8a8cc580c093b7429fb5b032fe1a21a479a4d00),
        .rnd('h094f6d4459dd13164f8ef96200f6b87d9bfad2614a1b1ddb79616ed07e428f1c)
    );

    // Testbench logic
    initial begin
        // Reset sequence
        rst = 1;
        #1 rst = 0;

        // Test case 1: Initialize inputs
        sk = 39168'h455d6be82563c9fad3f40e4c163ba5b9b59e38fc131154ad747158900e60b6254d592c6ce177477e0a7340c4de6329804d5b648cad995d3289c2dac39c15aea8d31a12fa1e454705a062c81cee046cd2cd683d027cbac72b0bfca47c4d3ddea00082548802f683b1c8df3708cba1c1ec5d0882831289aa1f1427d0eb25202d2f252dda80f93c0da79f5330620ee23a792622c80b41ea8f13d0d16b56303b289f03879625a1b31e4fe341047348894cba1b627416f5997169490dd5772802ca1343b997dfc056667e5ae135773cb0d7a30c8fa532de2cf995acc7197a648c77b753346cb6487ee17fb6cc085127cc34b31f88aea2b3f0c2ba57170ddc7d015578ba63bd5fadd389f2b15b5dd9451c6a5b3b890cc372212696971b81578c967adf864c3b3e4d554c03554aaf76f56740e2c652357e5fb99ea91daaa9ec2ffcd5386c88e1d925b65546dd9ef39059b009aead9d9dffe8303c79d69dcd2ce98ed71d63ef2b7a6536ebaeb7c4554c1b730e9ed40e3e2cb2d5821ec17606618b0da687036044a69cb7c01d1198eecc48c431a106837fb06f24b10ec0bdb692785136751043f8df84eb284977f82b537f621573f5b84169e184a726ee0e234eee10a38e16b894286978f9aa30cddcb6e6747dc803d44e1313028082468d094d34c9c0bebc2b32b4a59ac71517b4a662ab645cdde63194a30b6fa9d922f62d1f861d544a83d195ba2f67d66543b3a208762359b119b0b049e00f77094248d55a9ac8901707e0459b5d1ad63135e39a8dc7043127380f145705ccf3a3e70dab1ba444a9f184424612875624fc45a7b536e6f1dd65c27b123fd680e56f48c3745c9d56c3d8e57e8ca43ee030c3284aa900320597a6a557e56b1b981e0cbd5094425926180a3b10a9841aa9d95d425f5cc3fd41069f7f1066ba8fb638263258e19aae1ea280938de844ac02a6285c32abf97bf5182f644e29326257a71807f7a343d2dec313f879c0118f73b0ee8b49c35b6124723055a82bb6305bc41de84f2bb08b9beededc1d805c53e5f97eeea92047f693ba59bbb1c0e3360c2f0bb607ba47e35aad33da820bdb7cd515dcc0a167e0f249dd33c5abe5ee6f650c6ea782390bf5c633388ae89fd7f717e83bcba86eaf6c4ae03daa37900f8141f704c10233b41b11fb819d7badd586219346e64b83344fc2fd8634b7c59d1223bcb18742c796715b67305483b9dd988480c36984541a78dcda3dc0acf731894c72aae29ec30501ab0c3b88aebdcc7998fecb1879713b4ccd346d69dcb57ff6e6d60accc64c31f8a11c1128c8262c171a1d0135b222dbc806aa1b42dbba240cf36ae104fba9e5503c91153ea0d4ad010a4dac212db82ddb77def4111bf46e535932cb26b10cc48ef119324a09f8322d36b1ee58a4843ededcf121268f4b915864385606b303580eefdeefb078ec2984cc3e047a32bd126fc5ffaf4615229e37bfab11eb071228384c79d2e02b0f6bd1e668b9ff167acc89e8f54ef54b56b519c1ee50849d318a8efebee8612c36ba9c0a5f3a282e3825f73be37267f5fb4b58c0abc29fbc44fb6175c3ab3f09642d76d1eb1ad73ffe777aece0fde14b08b66b99850e17c4b9572f253a46d56fa384f0b4ff1f6a32d5960ca97d34d67f5287bd5abf5f58fc407eb908bc8bc252af9b4447116fe977c8064569945cf11289a3610bb278295cefb10c608cb491863978eae83ad095bddad06ef0dd9cb8702064e7803c94f0995a8a34f1731833c90e55857b0ef2cdfea78d324a87243949d349b603f93ff0cf91c7efbd1d52a3c26e5d9f6d9a56c41c1c944f72a44bca4191fcf32962e60518a4c68c0ed9acd384c299e88c2218f3d1b82c7cab0a8a3d269ac4c9ad45280baa690d534a6cf0d323718ff0c264add0233872017d135b9adc42e77d4210a5dcd3807407281e264248d02780ad29b4527d969769789cdf3f0a7e4762fd4f359d66f636a492176b1ce858afaf34cf23c2009a4fbadeb7193e8ec501fa6693cf46e2bc9abec53e7586cef96b592e614815ce13ba52a55b23a8dc61939a0801ed0c8774c67bed1de223cfa8c02984f28e72054c5f91ebf682ab01476c163342d65ff277fffeb687c87dc4a60c2025f6461915421e54e8a792667ed4c2aba457b0b585069baf9cba2aa8e11549517ce398fb8e1f313e1487277c445f97deccd218d1d9e8ba6c2f62f2b55cf576597af90c3fccc2a61c8636fe80034127236661ce71e64c29d3f9b5c9976d44f70776aa7e7743018ab550b5a2e9c1e889973b4b21afd25d4ca0edea4cba98200bb58298e67371ed267500fdefc549790545a16cbe6578df59ab794ef2aca06d10a2dc7b21d41f5c280d5bdedeac2d056f8f03c7042bcd627ccce177ba66308a39ad1dbf724001fa525324578bab9ef4e3bea48d37e1474ca16658a8503d7d24347c82eed47012a555e81f85c17152f8f26ce6740e3b8e0bbceefcb82c607188d05031c61956a12c63dc6f2b7bd562ee4f35d2df2acb025cacaa9410f624f87b86834c897946f17b0739d1fdd5a731e09066fdf81ade21cea101f622e4be0dc7d9fa00def72a051ba7db3a9b72e9c47bca1dd2bc896a3a4a0ba4ef2f91702716d83f850c11a64c5839cda625e0742307c7a835155e2eae89e2cd012f45275e696cdc0c3bcb11715eee6751601ff726dc0db12abd0dc858203a265865afeb04aab8ddadfe387ff96e59dde339f495c95077355691056739e9e10d5edc65975bd620c1a3c89fdf3f43783149cd8fbbf78e7c8bb9d42119552ada258cb6c4142d0175390f88db4f8d4c2d6e0d62311d20f69d7c5143627e6f813333162434fa2c525f0a14faca09e1e9fd2dac6f92a3e07a5faddacf993054c6800f02a5c12660895d1b18b279cbb5f6ecef2deba7ceb91f960999ecb49d8c31c5fe0bbb320e838543f4470be1e83acc7be4198db8ad032c6dbd7e07e114a95574a346e083027fe573713a064b9e6a29aa9cd9086a594ba97f0ff4f7661a605c06c85cb1638addd090d236aecb2065c9985ba380812ab836af8d2741e7f8d04b0e795a8e0147b72e330f9639d6747a0fbf17d79c1ac2b9fdb0b5c7f0408bafc4484e7d51cededb38673fe9d55aafdf36fe94897a67442807bfe9b3133e190455d7ee46d7921f81d977f7f17b9699a96bf384517aa074e95600bb5b4528a341a3f2b8913d1fc77f3c3db11c5ce18e9822b3bd55a79a988491a3581f72583ff4f41ea1d4288287c30e806da6a40404477f6b5a08c97c8a857d7c9cc99692e791118b9e756104b701ef1edcb95e4ce9b638f9cf86a719735f67b4e6767675d0baabd396bd0bbb47b71269a0eb150bfab8e310c3d425a639d915f11813bd02f61d5eee32482e16e5229bece7686ff7c906799394d19649fd433c4a7f4a9d41faf5148c2df567d4286112df1fff31441d74b7fd3fa894f4be06c923f00946a99301acc15fbcc85d60af4896948699141fcbba251749f45a386de983ab2c3a62660a83cd209210c180d41a6ff6aefc563d5fd40d49b51ed1d978606dfc5f807d3f4e83c0958af0dc5e473ae12e388533e806ae7ea6011df72ac7e30ad60828ac6ce086fd36f548f84dfe1f0f6a6575f988d37e07408dd629c68db836508360e6b7f985a07238e38a0fd7c80623c66cc77414fc6538c56ca223042c734c5a68481f79708968965f12bd183a150dc77032e057c3ba318f6b735dfa717e19e652b68c8c81597b6233c7a6eb89f51ebf66ffaa6f0c1912335e39869d5e9b416e171d428a9e2304253f9eeed27be88339ab40bb95cd308c23f24e4f240cf22b9000ce5f9e99f7ba17efb8f4eeb858aa053adc4ad154f27eb7474c3569b2592530dbe94dca356b42529e786c433e5340c448a07b337dd1043acd6337943be7ea2e6275cc8e315f9aa4e94e853915aa1415878d1a3c5a23c157a19bef0defcd22645d4d9e624e85f6958213efa28e2a8163f73486725ac5f1ae80baa8914ad26d4d00a7bf523b01c17d0d2b2a9e99773b176fe9add22479ab403e777290bf6f8bed184888a4e75dff0a5f88af1fb2877877c6dfca359918ac6a7579842c12257084ab5819296527ae4e8d2a5c019d44b1c70490b20c04f0a2a140b6d4d3eeb21656edbd2d9be62254affd68260a586e62455b17470199803bb0a63f0fb305f249400ddfa64e8cec0042785835b64a0767d0933378051c6e7a3817a9bbc84fe85f279ad041fe22727aa6bae31e31c35361189bf6c592c48dfa94362432b4814c502c03461226a974d7951bbed967cc18728f126bfabceee672efb3a1f59948171415fe63cb65c45096742a9a6c463d180f2cf0f0ba28f6766b6584589d82b9e3ce327f87fe6f1a49bde9df5b5c7a0fad0004e5c529ff69c186a21c80eaf704764c459b053f77b8a09f46f5b3120622283e26eaf238df503176ab7d6e7287099473dfedd096086497ac8efcdab28e41164f01b2a1a44442c867748609c49ceda6d497e13b4b4d3fdc0181bfe4cf7e643c539803bda27e3aad768bec71bc04832814748777ff817247a1615239e008719c46083ce6d3e5180ac1871637e3bb95b05cd77805015303a09d51009cfae09711731ef3780aebe0badabb0f3972ddd8554bc3c673714f4e5a6078ac38140c80b2dd5f58a1670f604a8e9530c4d7cb03762a2ff326806a10cd6cc7d6740518e48d94136c025801212150928c81a0894002cc86044971250a6934009220c19034cb30c2126c42a36d080a3146d82040dc65a21924381369c3247034dc8536d805a6db6d88d02c24418c271805104c20304204b8d269c20a6cb61289a09172320809171969b0402a405b0030a164b8c28182c461928109c82201380851b08130268b29c70c0002a448a8196c32190a02d92d102370a10c2c33108cc68925071182449810a1186cc88291891206150b62388c4226218818626c228b2a348c8e08920136d22a424910c70882004808c4912a16c304c6c104469c0dc69c21045b45449b8e32102e02c325b10b2926434a04c14947204d105320485c6dc11b89228c21c2425085180126538124947020a30c021a04a90b50251a8128442e40505227130c064982402280289b21130848821404a4a00596426234948ca82045065c4a489870c81990240b8022d32992590610e36c020a0044e425a6922da89c50a0102e411004c71061365a8584a00826627225206d46590a12c909172289c00901b80108c2db51a64a0a481b8cb7004946240da6528984d12c470b8629106405104228546806db8989130930435020642c032184c8e068308486352412051a6c42220a052121381851a0030240840008d41208604639036003090e484a81a04a22120329c2d44489215208110e40038519092db2da5207006586a10238c132191231424029229c8d12a44880498e45239000187100506222d40e28e32c10990c160844c8c16da20248806325408b80c9018231088ca7134621092905020d161411370c69a50051130b6494525100a312365041c2906842ca4c80488500d245868a6d98428044c96900038a380325b89285a0d40582e08c900a1040c91020e32a08024c92191036c385960860025c0a04094046d460b24241c4cc11c41400c1188ca11925268909b0034880e029b6247044c229a6600632cc4592824902238042910480a366148c4430038483148914981044212412c82dc6936da2c96820526e372148188b2c171c2206e34536e230a70861960a66368c64a2db8d86212148130d140a6046a04104012e38a26548c86d880902344a5092228504890532940128a19240146d865185224371b8d100929250a5118108c98902d130b69200240a41188a2d30530126e006304889c0a26490a06e12d27186915236448c100905b84869128a0130c850871301825c3225134828dc44380c0a104c45121945a2db2430909185186a106100a0d344c6d960a6d48c91140480180444d26db9046832984a22cc3012822c01232641117120a286464985181061b2c424905024800c2847010144c410141325408342021046151460c4a12db8c49128cb6e085b4934212d38239048cc6628c28140c480c11104864029486140370989c9118a14a310c7237210d921a28c8588628e17214530644232022136cb64965044040c21c7228e428325c8200409026494db10a4dc8d34536e16102cb41289930240424a8612049093102d46c110c7202a44418880134480cc4cb49030b24a08a2936226e429949929080c50050840401c6425104020623088d488c49100a81866110a8814c049c6998084924dc0816920126cc0400896cb6534db40831a4c401a31a8cc8216813020c32d24400e36d851b81b9245030c032012184464a6c14822d285011a08872409b30b68b2980126646d060c2014094244094db64c12040a72388150164185881c00891861b30249c48912165c92345460b0d410b6802a00ca0890445230cc6908c800882185a70110351472041a88001b8628918229026984439206101143124a21008c42c08a22526d069872248262409b81c7234434d22606890636cc09a7093210807130e02082112e471084981a6845202d18016199146224cb05c6cc28c61a60924230b8a440441c49c50c8c861451989880c29091c08460340a49c6486428410d309340841946190b04b4c344050271490870a85a50100b2c24e326345932dabe16a9633e1ed6fcdba043a43d15d525e1c6fbeb4a7af2d7cfe86969836bbc0ec52ee75bec23491ca1b17af8451e9f15a439e7f0305889b7032eca720bff4f960eca0d813e78aacc8f0cbda2a906c6e3fef616477bbbbc252095d721d1b3de50f981723b8110b744ce4763cb5daa32268ccb64ccb6a945e9f98a2b51e1d7;
        #1000;

        $finish;
    end



endmodule
