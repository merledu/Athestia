`timescale 1ns/1ps

        module sign;
            // Parameters for the testbench
            logic [8 * (32 + 32 + 64 + 32 * (((Dilithium_pkg::l + Dilithium_pkg::k) * ($clog2(2 * Dilithium_pkg::eta)+1)) 
                                            + (Dilithium_pkg::d * Dilithium_pkg::k))) - 1:0] sk;
            logic clk;
            logic rst;
            logic [37015:0] sign;
            // logic [20735:0] msg;
            // logic [1023:0] ctx;
            // logic [255:0] rnd;

            // Clock generation
            initial begin
                clk = 0;
                forever #0.0008 clk = ~clk; // 100 MHz clock
            end

            // DUT instantiation
            sign_internal2 #(.msg_len(2592), .ctx_len(128), .rnd_len(32)) uut (
                .sk(39168'he8604865539a473fba193111168aa2802a4968945b1e26faf378a60f2407716d7a7935ad159abe9c9be8b26f16b182bf924affb9e6e7dda4d79e08233f3ea4763241217f6658d996b9f1dd0e7c7cccbf36aa978c7916fbb9effd8046a4758e7a2d93240c9efbbebe11f0ea7c63dcfb9c0bac4e961bb8c0c4e92060e779ad820e5fc773d8c913d835be6dfd168d19dd04d68ff8462a508a861c9ab5b7d4bc9c3290826da9d104cd43b8b0e2a93b8513cea83762c01f6e6174c3c9f3d70f599654162e9c19640aa5f121fd0ea78788beb6d3909cc0ed256172936ba087d47677d9a8479222d7dfce9afd6137a109b47d3254f6e2f05d9a11b98de5201ba4885aca71b9fcab58f2f22d519f7d40238eef111f1cbed98e89c32fd4c2e126c156f604533149c5824f0a4312dbc054f12fefd17020acae60eb4c4e89181970e767123bdaaa9b125b53ca8fe9568229ef159d703c641bfea0a2f8b9b6603bd708d9512c15b26573f70db441ea1265f031e0b6a6ee66c4a53b241e79d89912dd0702dfa18c4d7459742a74eb98248854a898a89a331786c99072899edd7b87505193bb684d73a3b5021fc509cee486c8a58bf4c86faedd8830d6abe256ec755375c8bc102071881643cc4ad5f2528f371eb8d8d99471824b142d78261e538bff8a2826dec1ff0c4f06f02a07b46e8dd183c09dc51c6d46bd4d051961bccd1c1b6eb1cf962e8e7202f110b84587a3c509ccba36959d4344cc614995b60a951b67666d79df10a82d989fdcf93f7b26bd09a9d936ececcf2fc566792c4bfc98e2966826b46ff3ee193bb6839118f4a91557a088b149d10976b8137fbc57d28fca8197d4e9eaa606d907ae25446f4f1a41541cf21c3b44de1c8a9fd256fbf353a940da91d014592e5c43a8afcd59c4dc33db0c19d3580fe1242ae17ef4af875757ffae9134a8a5471e0ef6afceb620f5dc5f81e001d5c4fa2b91521c7c87d5f6213554c026e85f06f60471686782138bc3797d1445f26b69aebc2aa34a3c1a1d36ae524b98b88220ba92869e6142a24a213ca94667ec8fc53cb283973de025af093247275d6a14e732703d34d2f2c6119df6b6f44af6b6c3fafb82b99e0e8c272610c9428876f0be5b0c298bdf8266b919cd7db026203401d25230e21d8dcd3f5905acf25198b001cdc2ba0a123771deb7576f82d1cc32aeff8b907cce1758f058055cb99ae1fdde2acb7890f3a1d764f509db11f44c98d61ee6d815e680c83a457fa3e1847e8f8fe046b99e34731026c1a59e4c7901716940242c47e2f304c945c04f6ee6fd619ff957ebf644917f2779e9238c026bafdba374dd4e607e361c763f35ae7fe09a45262c7fa7fd7e38aa35cedc08d51a3c45bb060551dfa05705f11ed0d383f3e6168f60165437a0372919a7605579d0cdfed0dd65928d2384bcb1ddcdadb462f6bf3d5d1eb9c61afd811c491bcc42174dfda45644078ea5adcbeb24ae57be533b7d873d5d6e77119c8848a2dd608d04d1cc38b33d24b6ad00015a4abbd77e7439807d4ad531a8fc993c6f83d74f9858a7d2c5e57f5a3151dff38b33321e2d48e97d8b74280ef2e777f0c2d034d5cfea15fcb4f47eefb19ca1fe7569f8d043a7996cd58f19a7ace0f73c90ad99bc93d8e0f780afd082c108cc7ea99142b940deaed543b4603d1545f7fccb63b97c952245934d2f82bf258a9904a31bf3777bcb538c1c6f2d246bb4a2519bc1be768d87fa52871338dd948d148f20d37dd0f750155931cad99e4e4633261c0bd53cd94ccfd5d19a9fee79ead3905c39b2ec3d46a6edf5bc7b1ae127ea94b52bce1a0050679609268b72d9dc392e3373b4a6c531e297a4fcb10aa34559eae822dd38e0f3dc6fc535cb00ed83d6b04005d6efb2d80c5c418c632aa1d3d40ae68a2142b5518820c0f7881c3a5990f2b004b3d88ac25e99a692af201a181a6c02fe3dfd9425412d7ea34e99b0c96e6d1babc7d505ca4634fffb1737d570088a33696f4f54b5b7cef9c2e547bf7a077fda02d486301486ed901f0cf7b9f88f6c9e2efcffac2e86d23d79b2b60c8d74c1266a4871312a23cbb2cd376dabbeefd594275569dbcb250589c35ca6911365fea5d0fa252a590d356c235e8951be8bb60c14fb9360cbf9e785cea766ace5c08b112e79ad366f9d7626cdac9fffd775bc48d663c537d504f051db9664dec7d8ead7fdbb4e0e880241bd9ec0e3d66255f4fbb6265b1a48e41ffe55e0c9c365907418161db678a173ed735deedd72e10ef242055e93ed42f926e9627fd1646b68e44d359aacbdb08595c05ec02e7d9bd03772c3647b7fc875ea02f9992afbb9e83fa438831c3e8ced6e090388491ed261e8601b06da24b3fe9f24d4a6c4ed4c97682311eba330ebecfb8a0e10b4703c96c164685cb2cdda60bd9c62049c621d7d5a21fd64b3c45342ccd4577e16ad4934e02726ac3f46821e22b9e654978a0eac90561e04bacdd7953602fa9c0bda242012b4d4d2649ecf39926fdac99577a9a96e7c489dad16d22ef954ddbbf361935ca0e9f1679e01fc3d7b09b8f798d2488fb9e8f955e406078998105f0cb41eee675fe5d81fdedd94ae36338d4451e455e8d6aefa4a5c2222472905f2665661f52e9da173b643b42c96ee26441d3c46d66cfe8d65233e9498865dc419d78ab041facb06d63fed70b1708752b1dad55e953b5e9b996f0897938c81a4f00bbdfb2c31c507b481fb8654b8aba108234507ba0884d9494047b404ef6a57c536f17ce8779fed5efd9056a9b0505ce3ef61db93339a2307d2919af5f6aad7dd08ca312823526bbd19eb3435b3acdcadb01efdb4c0d789728081f14e271c1cf039d5a30361ff439325c2a69ef54e9f78ee03cd85e0e8b25ccb7806dcdb80bca28d165d97d1646197ae60f5ef7e2acd31564f6d8da0899e942b1ab0e05d087b86952b4045a69bb82c9ad1e30fa6ee65e56603c8e61b4cb26694517ce85dd1284abc9e2fedc3dd22288446f52dae1505a510f3ef5c8801170a8cc0441a1dd1a52f0b8bd137e3064e6a8272d5c67dd05e54852ac40d44d85de9f2e4b692bb250c02f8741d5a16ccb57762c9f60add754f67254cb7d01977b45639d4bb245c60f244f3a3416ea662c3142d29a8e6a03054115908c74da274a47375a7ce7c38342c2bd0d3a58450f6f3e369c4d1a8bc5c8496c00951c83556212304be9925d556b63b3307c126090814f53d7e360a26540badceea4f6587228eb5f850d7ea59378b7663df24668bbcc2464e2ee8381788324b0020aebf03ea8004964b9f55cebfd7fdbe61c7915ad155805c8d5e02e891f4fbe55f6a15b44305a7fa0e9936df90c0b84c8e5345f569631634d1978f30bf933d260473c5e3546f28146b91227cdd84963bc06d48afbdd89d33e33ec2619e9ff8eb53c25ef2d775e55018dac793febd4935798f39dae2dcc7e42e8fd736d8025bf37994b1043b0a71546128a140743e12522ad20eeada411515dbb669883f4282777be20085fc6a8c0276610702a035ca19b812fabc3b2e2ae8a173083d898ee30c28aa6a1ff773df0517f03fa004b5ecf246cd3d8606747a2cf7342e266e15065de394f0e0d6af14177479d609e833d112cb8c3b96fdfb923b0182094db073cb2ba0c689caae54648af99816d7d5673864e4a6478865414f4a31927d5e2246c2d4ccab5f1cef439c03478e0fc48b1d6989010ce356f618bf9af1909606ade563531faab272cb84e5ce7894c48e87c356098009dfecaf177786fd51d0341400268c98772d1d7b98fa36199856977dac3180626e4640b3e9fc0c71176c9792b3dec15c77b2c127e9a66799c477dfd87f4f36915abc9105ac55a730ac34f49f5c2d1fd2b8e84ab11b55a9868c7ebe4bd0a83dad079ed8e415812aaae2b6a842a3e2486990c5a10e044c938d24ff79e125286bff022c5639ce8109485c2234f454bee1f32eff098cb4fc5f0de825f4818e3f7fbe074df711561bd52544bb2f15cd282bd5132ad95e09b7fcef2d45d1cd83ccea95bddfaf8f2f53535f85270ee422a94699fb950e337102039dce42fe24680cd785467c923c4f3e14ccdc4e91576b8d5699512a8dccf015f44253f343a969969ca00dd4b004ff2bc12134493b8f25bcf92b802fc24129998b8ce4b1a211ff6033f96819c25b163504e8ac7a98c9163f455cac0946ecc2a4b08aada5531c8f923644f357be787d505ad62003ed20bb80a2eda3fafa7aef8091a5f33f633a0adaf8825410eb8b4d32daed8ba37ef432d6d9000b45e6d230735d4e69d06192173c837d91c3eff4ec88eab6495ecb2895c5138ef2380c61558b9ccc35fb9fd1e952b8a1028e1704adfa4b9b0c50ea98000bc68cbf6997500e5d758cd34d196ab243aa76c523f8505366512170dbf881679f742dd6cb3e7ef510a62a537dd1797a5de160d75e9b0ec4e375536cf59fdd08a0be2a329dcfbe52b440bd1246bec11aef6294e5ac29dc01b02c223e0dc5e9722a0de5462bfc1bf5705d49180675d0eb781157f847c4d824b9d39632c60b114f58a3001ad0c252c45671befee493894516eda81714171c511145e90e2c645411176d7272448840fa003495f3a8035d48dcfc982eedce2317fb5d4c7210e25c6aba2292ae8072647750591211ff5c8f76f1fe2df8849e5e9f41bdc7390ab4d5fc77f4194b00fbf17a866e2e79d360a70b00384a4e309301228928488c0602529012508e08c88a390084c4cb0232200884847214a34596c18c329850b6a08194929034598917008ca51a71b6c14c944145b00b6202a170c4946223130cb2093036d24d920a0448d48cb4c120b11b2528c46e16188a00626e189920b9048dc68970168369332120c8188e206121941c66451191204a7212916c14498c950b01c4a24a160a69a0ca89844189c61c0546842c18806932e431b0ca81285391b90300308202325981011b9039180800d028a20405c0442e08646a46437036622808a428968069492085128450a4e001190a32445401a60b7008da6004cb00a08260c0812144c961931240a84110c4584c01031142a44a10ca05104100850220270b6000634e204c70b6e46a10241016ca7106626a340c51a8034e06c30992d862151929b08961b0e34938d191850445c29b9039230c92924926d330c01949a7238610a12243102806618998514c945060929882192332284b28a5016236122c92cb2da49b4da2a16812d352251b4e150960c1036ca4a26042c04e241106165b65225121946088824b2912cc6d86d38480c942271388c4818035224980cc2998404008c36996920d41080192243089200830016a14ca01005a4518902d82c281c41b2a069480265965c3003214a441369a10820884b9020415122a02200a36542441098125211004a00898110820c00cc2dc9190029010da62351b02200c4cb08a8d941b0897034114630205038a28530912810e01230c392186160c2ca41a2dc12300a04a0c844a65c00b10228b6d06a280361a49c8802a344912231a4642512482026a110082170460124b6420e00618918c14944135204d94dc6d42cb6da7188c12d180c51820a44308a69c46341a48324325391c28024444b2516c10d98a08498020542180a04426237204c85040043118888138d341a8e48c880b48a08884a8a052161b04311168010350881b9116db68c68489384c7044206a18d811984b3047098d96016042d24236db0d049049851a71321c8806a26cc8582508400436088980a36a30d06908da24c24c6c84232908582e28844a165c8038a270c4d146368924971a65961249a60c0d44888d42429188cb1047238898a201162230065a28041c60050b2442627197100d36580d128088c8544dc6d852048c45b8a20d871471110a4a265908b2d089031212051851986384c2c401c4132cc4d341448c4a30147134016192a28846c01224004c12e42224d101c62448924825292026481b69b0d931a8621125231180034d330890c4604e370b6408d46c92484c36c35108e005190266386411c6c18031148d446440c61b46184130800846091c09c04c6c189148909209a0486d06148da8428c98432db2ca8c01209026926c870c4111214844417146e04a48c24a20042d18120e23024210514028990da8c80132124016a20419183185196c346129a69960a24a00a8508532090624c369b2a281064a42360a70c10961342020245c60241425c20045a6888e00490598914c412451a8a122028a2230602e38614012944402cc6130ca64a8d950c5010d88490c13112484e024c42141020220308b12430a10190b4804d191a6114a346368169c6e05083095043210a43094821090926ca82448b3000a16634c92488dc5126d861b6c810960189942044a8c889960a6e28536184c960040b11200b2d27138cc6d031848485a25a32401451850a1194c06026442915006448104216d19194182986206e34196132a041b30029b4910896d969341121a6c969821221a31170451069324808029b51889405b8e46e11040047104a229309c71429a90881330270865c4a16d26446d962125124a12128b8c92e051b6db4d34588a34240d34542d12a45012813228a185a30b60c48b7186c025389100a21c88a4423216638992406c344121a84084c04a81a51105a2e48448084142986218da8234d290021061b2c802101268330b2840c44130e448b6029032608409022ce8700f093c2e44a712503d1fa1ae0b26db6d8eb6570d07f7c4c7c67757f476bcefaf5af980417bfe8bf3ba1efa1f50f83fd10e9ca00c15d63f4f48f762603489f96e9471e082efd49e96c190e7c6b835c2dba6073175b75ff7a48d982ac74900f4446d445eab69af0a0be373183f2b0051fd837a2b166cdcc9d486174e3633),
                .clk(clk),
                .rst(rst),
                .n_msg('h8186c9e1bda7f0600bfb24a75ddde609148279bb6622de34bfa02c189e3415ad1e1ff30c074b34a5842a18a7159769ceba4d36a31955573b277e78680cf602e4d0008f2c3995fcfc4c2c9ed0017c8c5dec599c3f1b42338ccc4b2e4c442bcb37d6a454b65c3785a9d35ce1c9e6c903f6b3fa68a469c4b709ac7d619c461d160f6cd9e8447953305e4b892cfab7ee1848475e5e6326898fd4798a76af7c4840c01f1e8671f8015a75fd48420c6f0881d09e6c8ca82d17fb6598fa91e374e14de2db9b03a61a45dead3919b2eaa7b01ebe7abc41cf8ac1184ee425917fa1d5fbde6fd49a3b192a440253af996263008e632c40e3f277ab9e525434ddb0cf68b566d8a95aca7d9c2089c16641a60a01e09cd0869c480a17fba794cba30200569d43984864c261683250ff16695d7580cb40fabace61365ad9ce5ca55acc247592171eb1f86208c8238de9be0176f1269262d1878e771d7699cfcd4d6c670ef3782f05e8e2ae9cacc48f957f17b30ad0d48e4133bb4225b71dd638f5ee4614d5161716e78e371aa7c3bf2ceac09b25c5088951469f3f86a99c367f6b729dd137af6c01341861241ba5ddd72afae3456a5ded6b2d319dccb54e386982d6ef499e80cfd1f5919f45f08f1bc334aac33183ae385e90f066d118f1a62c7ac5c535a4ad5e225349ab65336014fba6837e6c4d14af02a7200cd16d241550a0c1fea14f0e4137e05fd798a163a62c8459729a0fad9ee6d09f01bb862c7a94912ee471999164f7771e88d97fb8c4b7c8f4b32fc58ce51bb4e20f8a19beea003a83679ddd52dfe6472914d3f138f027d9df49277eb8d74f3b05836f10cd55e70415dd54197450192e1eb9d7bc0c815681465095117b8b4e2c93d7aef03c9e386dfbc8415e8b6878bccc9e4129560aaf1b3db2c38bb7e6f9a613925a7ed341cce9a3a5ba472e1ca9043b98656355300099585a0d48ee0c089f10709bf580fb06b11ac48aa11554c868f4a1066ac42ed0ed5a6a0f3c607bf8d2ebb9ee37c8f4104487456766b1b814d02da0c352af758509b0cefc6b2b93876fe341ab0e2c0abf526ec7a2a2c2c2aa54e5019e689f3e2f33f52eb68181b49003201ade50b0ec9c6a061e818560bcd39b7d8c442c5e45586a6415defb883b81fa56b7f8f217e0178b656605c7fcd4d4c3cc094311e7d673090f09a13ec9ceeb7c585eef3089e0574d797b7266311fa3591ebcf2d4f374975aa4d1668fa80bc0dfda01a7e735ccdcee2ee3df4ee1899701f8a8e3de1d25c05f6e61042f4ffabb4e386d2b6a3f0ed6399da7caac9661b4ad2544c42bd285c338428a4e555b00043ab1fa0a1311f27fcf8c5993f9a5fc4b47745ecf1919a31fc3d9cb0048ff25e450db0bc6a5d65406a81ac1afc32cb6eeadea611cdba2633eba089c6a791cc069c8db5717a5460d025f153fbc3bc18ac39239d4b8435d48bc4ea4db3c2011e200f77e6a530c9ce32ef9d45c7ad281250184558dd74eb3ef6acbfa1214cef25b7799a5af4b1104b5db396dd69024612096e43f2251ac9227ad44194d5f5ac8102a2306d44db2f639e515c33f21eb6b1a3e73ce7954c60e698de09771c71724e76e38309b6b59a3f8ebbdc1372613298200f39b8d9f2fd0784b82063dccbb8f520483c164852ab64d65ce47b9c620349c5141399d3dbd10245767dedc50530b28ec1db1a9030b9fcfd5bf8c29bb83f40e2b7b8b50ae18b911b0878e5e2e80d30517ca0ee32182702d201b1474e9c2d82def6ee0ec2c0b20e5df016b1404d57374edfe5ab9daf8eb0b48ead22ae9733c69412f6d5f129463ba2dd03ab73254faf4f4752c5e0f2367e6504ae6a4fc8565abe9ad54ea8781a4ccfecbfe46bead6af9307da92cd0245563fce4ec069f823f4a437cc21242e279d587520608c56db786ae4e2165a049a682a79e8781936e8672605791f91a729797b03d69d85568ccf160ba7089fa4f4e345024956cf3f1bf152be41b60c72e7c091b2fe589bb556088438b52e64aa62ae2dbf63fce09c3180e267df139c9e1156310490dc158c72f9f10d9ab8c652d18bd404b46dd546f2e88a757f7fe182a7242797c68abf6da836506daa30eb98079f888251b8c6995806ef7b3d3276b221ad7d4e19c563051a6b323f644b169a4077461eea41b78e63befd4cffb7ae2bca66b373a7032bee70866186f71cd5a39d7a8fa898736bbe98b8a94a96b0674dcab4d2f772e60188b5fe99d3831696101a28a37799176222b363d577179c0fbd1112a14fcbcf66186abf650b35c25f33bac97fa7f8b5ad3d93f2a468f43d537746c1a2c23c9462d794d10a64fe478c5f950f149b59d622fc072d3bddc9ed4694b95165860e9181283c05713101493b2bf00d7bd371e46a59663648b255b76a4628ab8413047c0ad94f9ba4d83ffe98d5ca1457315f853054de2e691967db42e9381e2e4edb2f36386a69a6f0c4b81ded5493cda2bc6c92cd49a4f18d4552e9cd0852d5264c511bad7ec17b248bad87169526244c5b4e5f49e62bc026ed257e22b5415dac59c7b9ce263038be25620d42bc972237f0e6bad19b18f71d1e59e00ee7fa513929346f87ead9b3cef5199a8a1e6c02f83ddcce66ef90e4b014c54cb01f7fa7a3267573c13c620a57a458a825aa9569d7dd7783cc951bcec9a1530232def7f521e4c296d59e82ffe4d69d01506ccd8bdeeba5978072ee6229ffdb32a5a597427c7cb763bdbebde3b82c24f7bf7d3bba7c3e061e8b197203c9d01479982f80cb3752fe1b159ef345af2d73be967412f566da77259bbf81afb76fa88126f5f6d886f7d8bca9046e52d5cfc5b0da49707314089c6fe0ad0a1fc10fc7c79eed8266a6c746aa62bf14555a8f3828f5ef82f36f6fdccb41d1de365835e65536451b98ec592efcfe51c03a9f129cd2788805d14c759bad89b688796d4246bf756b53ed02cb668353ec94c01ef7e743a4e3efa261c74af1b7d853756ca552969a4fdf268498e2ca98cef8d7122eb4a169a2961fe93bdb6df181134b98e29053bfba035de895982f7905810980838ef4b64a2c293c187561ed21d49d4b1688622e1a2875c42683c2c5336cdae09a8ad85c2727309fac00bc550c721e74a4b7571d61cc260be57049e80fcaa0ac6173268bc05d96416834f0013238e8339c94d7d95d49aedca5041d6456ceecdec70b34dd9c13a9df63b413873387a08adf8e6d53fd9d66fb7291c4fde64fb78fa522b296003909585d21d01e90edfaa92f1e6afe23b08abf559363228d6727ccd9b3bd75b1a9e4c33d943cbd839ed65af589b55050e9f9ed30d2bb6f6268d22e534f01db319f336f4e653bf7db9fb5747870bf87b1c3e3e4ede605d5063c6bc8fe7e1441807eefd0f77f231d28f40a5a6075a1ca873b392c143326dbda93eab3a3b6bc0aeebdc037ba02a3b0a246d7d51dd9ff82b33c671be1d4a7e8297a05b2183da087402860f721259cda5f8c7b69fa900932fe6e2405d9c35ad5d762a26f8f64e6078c6bf69429ff0b1967c014693daad4dd37b42c0df85fdf2e6f2d6fa89ea2529ae3beda3b7503adf725970d18a1fac2e391996226977ded689508c2cf52c5ba9a32c3a99036db4e440cadfe04f5ac502dddcc13441b46bd4ed24e3d387b72cd63ea169ffdd9d273e51d24a),
                .rnd('h3989dfbb8446bca2849e1f420bc5fd93bf8fd0bb0d138a2dc86b3041f860382b),
                .ctx('hefee10c54afbe5593444012fc448e3609d1d60641510c52bac029a91549e2549dee1804122a4a2f33e824223eb1f1a6b58b2d82cb792bdef072eb2c795e4d4341f48fffb881b24d396370e19dbdc51b0beb78d2028bc3b279d892df01db8e2907f503880b99c5aa2459c3a4cdf61fd89f05d3fec3516775703b6721cd590554b),
                .sign(sign)
            );

            // Testbench logic
            initial begin
                // Reset sequence
                rst = 1;
                #1 rst = 0;

                // Test case 1: Initialize inputs
                #1000000;

                $finish;
            end

        endmodule
        